import{a as Ye}from"/build/_shared/chunk-52PIBEMS.js";import"/build/_shared/chunk-7MZLIYXF.js";import{A as fa,B as Tn,C as ma,D as ha,E as ga,F as va,G as or,H as ya,I as ba,J as Pa,K as Aa,L as Ca,M as Sa,N as Ra,O as Ma,P as ar,Q as Et,R as wt,S as ir,T as Dt,U as Ln,V as xt,W as sr,Y as Ta,Z as La,a as ue,b as ra,c as Rn,d as I,e as L,f as Ke,g as Tt,h as oa,i as qe,j as nr,k as rr,l as aa,m as ia,n as sa,o as ca,p as qt,q as Yt,r as Q,s as la,t as ua,u as Lt,v as Mn,w as In,x as pa,y as Me,z as da}from"/build/_shared/chunk-76MI2ICR.js";import{a as bn,b as Se,c as Wo,d as ea,e as Re,f as ta,h as Ia}from"/build/_shared/chunk-UW352ANS.js";import{a as Mc}from"/build/_shared/chunk-HIQ55532.js";import{a as Pn,c as pt,d as It,e as dt,f as na,g as An,h as Cn,i as ke,j as re,k as Sn,q as x}from"/build/_shared/chunk-UURUWQDK.js";import{f as vn,g as yn,h as tr,i as zo}from"/build/_shared/chunk-THAA5J2T.js";import{a as oe,b as k}from"/build/_shared/chunk-DUH7O3SV.js";import{a as Rc,b as F}from"/build/_shared/chunk-4BW2JWK3.js";import{a as w,c as mn,e as hn,g as gn,m as er,n as Zo,r as C}from"/build/_shared/chunk-RVP37ENA.js";import{a as Cc,b as zn,c as Wn,d as h,e as Sc}from"/build/_shared/chunk-DTKMK5PW.js";var wa={};Wn(wa,{__assign:()=>lr,__asyncDelegator:()=>Bc,__asyncGenerator:()=>Oc,__asyncValues:()=>Hc,__await:()=>Gt,__awaiter:()=>Dc,__classPrivateFieldGet:()=>jc,__classPrivateFieldIn:()=>Kc,__classPrivateFieldSet:()=>Jc,__createBinding:()=>pr,__decorate:()=>Lc,__exportStar:()=>_c,__extends:()=>Ic,__generator:()=>xc,__importDefault:()=>Vc,__importStar:()=>Xc,__makeTemplateObject:()=>$c,__metadata:()=>wc,__param:()=>Ec,__read:()=>Ea,__rest:()=>Tc,__spread:()=>Fc,__spreadArray:()=>Nc,__spreadArrays:()=>kc,__values:()=>ur});function Ic(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");cr(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function Tc(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n}function Lc(e,t,n,r){var a=arguments.length,o=a<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o}function Ec(e,t){return function(n,r){t(n,r,e)}}function wc(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Dc(e,t,n,r){function a(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function s(p){try{c(r.next(p))}catch(u){i(u)}}function l(p){try{c(r.throw(p))}catch(u){i(u)}}function c(p){p.done?o(p.value):a(p.value).then(s,l)}c((r=r.apply(e,t||[])).next())})}function xc(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,a,o,i;return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(c){return function(p){return l([c,p])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(n=0)),n;)try{if(r=1,a&&(o=c[0]&2?a.return:c[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,c[1])).done)return o;switch(a=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,a=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=t.call(e,n)}catch(p){c=[6,p],a=0}finally{r=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function _c(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&pr(t,e,n)}function ur(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ea(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),a,o=[],i;try{for(;(t===void 0||t-- >0)&&!(a=r.next()).done;)o.push(a.value)}catch(s){i={error:s}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return o}function Fc(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ea(arguments[t]));return e}function kc(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),a=0,t=0;t<n;t++)for(var o=arguments[t],i=0,s=o.length;i<s;i++,a++)r[a]=o[i];return r}function Nc(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,o;r<a;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}function Gt(e){return this instanceof Gt?(this.v=e,this):new Gt(e)}function Oc(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),a,o=[];return a={},i("next"),i("throw"),i("return"),a[Symbol.asyncIterator]=function(){return this},a;function i(d){r[d]&&(a[d]=function(m){return new Promise(function(f,g){o.push([d,m,f,g])>1||s(d,m)})})}function s(d,m){try{l(r[d](m))}catch(f){u(o[0][3],f)}}function l(d){d.value instanceof Gt?Promise.resolve(d.value.v).then(c,p):u(o[0][2],d)}function c(d){s("next",d)}function p(d){s("throw",d)}function u(d,m){d(m),o.shift(),o.length&&s(o[0][0],o[0][1])}}function Bc(e){var t,n;return t={},r("next"),r("throw",function(a){throw a}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(a,o){t[a]=e[a]?function(i){return(n=!n)?{value:Gt(e[a](i)),done:a==="return"}:o?o(i):i}:o}}function Hc(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof ur=="function"?ur(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=e[o]&&function(i){return new Promise(function(s,l){i=e[o](i),a(s,l,i.done,i.value)})}}function a(o,i,s,l){Promise.resolve(l).then(function(c){o({value:c,done:s})},i)}}function $c(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function Xc(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&pr(t,e,n);return Uc(t,e),t}function Vc(e){return e&&e.__esModule?e:{default:e}}function jc(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)}function Jc(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n}function Kc(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}var cr,lr,pr,Uc,Da=Cc(()=>{"use strict";cr=function(e,t){return cr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])},cr(e,t)};lr=function(){return lr=Object.assign||function(t){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},lr.apply(this,arguments)};pr=Object.create?function(e,t,n,r){r===void 0&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]};Uc=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}});var Ao=zn(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.isNavigator=ye.isBrowser=ye.off=ye.on=ye.noop=void 0;var Yu=function(){};ye.noop=Yu;function Gu(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e&&e.addEventListener&&e.addEventListener.apply(e,t)}ye.on=Gu;function Qu(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e&&e.removeEventListener&&e.removeEventListener.apply(e,t)}ye.off=Qu;ye.isBrowser=typeof window<"u";ye.isNavigator=typeof navigator<"u"});var js=zn(Co=>{"use strict";Object.defineProperty(Co,"__esModule",{value:!0});var Vs=w(),Zu=Ao(),zu=Zu.isBrowser?Vs.useLayoutEffect:Vs.useEffect;Co.default=zu});var qs=zn(Ro=>{"use strict";Object.defineProperty(Ro,"__esModule",{value:!0});var Wu=(Da(),Sc(wa)),So=w(),ep=Wu.__importDefault(js()),Js=Ao(),Ks={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};function tp(){var e=So.useState(null),t=e[0],n=e[1],r=So.useState(Ks),a=r[0],o=r[1],i=So.useMemo(function(){return new window.ResizeObserver(function(s){if(s[0]){var l=s[0].contentRect,c=l.x,p=l.y,u=l.width,d=l.height,m=l.top,f=l.left,g=l.bottom,y=l.right;o({x:c,y:p,width:u,height:d,top:m,left:f,bottom:g,right:y})}})},[]);return ep.default(function(){if(t)return i.observe(t),function(){i.disconnect()}},[t]),[n,a]}Ro.default=Js.isBrowser&&typeof window.ResizeObserver<"u"?tp:function(){return[Js.noop,Ks]}});var ap=h(Rc());var sn=h(w());var Te=h(w());var xa="/build/_assets/AIReady-R4GFFAQY.mp3";var _a="/build/_assets/Join-5QBI6SQX.mp3";var Fa="/build/_assets/Leave-W3LFEYQC.mp3";var ka="/build/_assets/RaiseHand-42IIBYRT.mp3";var Zc=async(...e)=>{oe(!e.some(a=>a instanceof Request),"fetchOnce cannot cache with Request parameters");let t=new Map,n=JSON.stringify(e),r=t.get(n);return r||(r=await fetch(...e),t.set(n,r)),r.clone()},zc={leave:Fa,join:_a,raiseHand:ka,aiReady:xa},Wc={join:.2,leave:.2,raiseHand:.1,aiReady:.1};async function Ie(e){let t=await Zc(zc[e]).then(i=>i.arrayBuffer()),n=new AudioContext,r=await n.decodeAudioData(t),a=n.createBufferSource(),o=n.createGain();a.buffer=r,a.connect(o),o.connect(n.destination),o.gain.setValueAtTime(Wc[e],n.currentTime),a.start()}var Na=new Pn(e=>{let t=new window.AudioContext,n=t.createOscillator();n.type="triangle",n.frequency.setValueAtTime(20,t.currentTime);let r=t.createGain();r.gain.setValueAtTime(.02,t.currentTime),n.connect(r);let a=t.createMediaStreamDestination();r.connect(a),n.start();let o=a.stream.getAudioTracks()[0];return e.next(o),()=>{o.stop(),t.close()}});var Ba=h(C());function el({key:e,disabled:t}){let[n,r]=(0,Te.useState)(!1),a=(0,Te.useRef)(null);return(0,Te.useEffect)(()=>{let o=a.current,i=-1,s=()=>{t||(r(!0),clearTimeout(i))},l=()=>{i=window.setTimeout(()=>{r(!1)},200)},c=u=>{u.key.toLowerCase()===e.toLowerCase()&&s()},p=u=>{u.key.toLowerCase()===e.toLowerCase()&&l()};return document.addEventListener("keydown",c),document.addEventListener("keyup",p),document.addEventListener("blur",l),o?.addEventListener("pointerdown",s),o?.addEventListener("pointerup",l),()=>{clearTimeout(i),document.removeEventListener("keydown",c),document.removeEventListener("keyup",p),document.removeEventListener("blur",l),o?.removeEventListener("pointerdown",s),o?.removeEventListener("pointerup",l)}},[t,e]),[n,a]}function Oa(){let{partyTracks:e,room:{websocket:t,roomState:{ai:{controllingUser:n}}},userMedia:{turnMicOn:r,publicAudioTrack$:a}}=I(),o=n===t.id,i=!o&&n!==void 0,[s,l]=el({key:"a",disabled:i}),c=Sn(s),p=(0,Te.useMemo)(()=>c.pipe(ke(m=>m?a:Na)),[c,a]),u=(0,Te.useMemo)(()=>e.push(p),[p,e]),d=re(u);return(0,Te.useEffect)(()=>{s&&d?(r(),console.log("\u{1F916} Requesting ai control"),t.send(JSON.stringify({type:"requestAiControl",track:d}))):(console.log("\u{1F916} Relinquishing ai control!"),t.send(JSON.stringify({type:"relenquishAiControl"})))},[s,d,r,t]),(0,Te.useEffect)(()=>{n!==void 0&&Ie("aiReady")},[n]),(0,Ba.jsx)(k,{className:"text-xs select-none",disabled:i,ref:l,children:o?"Speaking to Ai...":"Hold to talk to AI"})}var Ha=h(w());var K=h(C()),tl=["Alloy","Ash","Ballad","Coral","Echo","Sage","Shimmer","Verse"];function $a(e){let[t,n]=(0,Ha.useState)(!1),{room:{websocket:r}}=I(),[a]=gn(),o=a.get("instructions"),i=a.get("voice");return(0,K.jsxs)(Dt,{open:t,onOpenChange:n,children:[e.children,(0,K.jsxs)(xt,{children:[(0,K.jsx)(Et,{}),(0,K.jsx)(wt,{children:(0,K.jsxs)("form",{className:"flex flex-col gap-4 mt-8",onSubmit:s=>{s.preventDefault(),r.send(JSON.stringify({type:"enableAi",...Object.fromEntries(new FormData(s.currentTarget))})),n(!1)},children:[(0,K.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,K.jsx)("div",{children:(0,K.jsx)("label",{className:"font-medium",htmlFor:"instructions",children:"Instructions"})}),(0,K.jsx)("div",{children:(0,K.jsx)("textarea",{className:"bg-gray-100 dark:bg-zinc-800 w-full",id:"instructions",name:"instructions",rows:15,defaultValue:o??"You are a helpful and concise AI assistant for a video chat application called Orange Meets."})})]}),(0,K.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,K.jsx)("div",{children:(0,K.jsx)("label",{className:"font-medium",htmlFor:"voice",children:"Voice"})}),(0,K.jsx)("div",{children:(0,K.jsx)("select",{className:"bg-gray-100 dark:bg-zinc-800 w-full",id:"voice",name:"voice",defaultValue:i??"ash",children:tl.map(s=>(0,K.jsx)("option",{value:s.toLowerCase(),children:s},s))})})]}),(0,K.jsx)(k,{type:"submit",className:"self-end text-xs",children:"Invite AI"})]})})]})]})}var ja=h(w());var _t=h(w());var Le=h(w());var ft=h(C()),Ua=({tracksToPull:e,onTrackAdded:t,onTrackRemoved:n})=>{let r=(0,Le.useRef)(new MediaStream),a=(0,Le.useRef)(null);(0,Le.useEffect)(()=>{let i=a.current;if(!i)return;let s=r.current;i.srcObject=s},[]);let o=()=>{let i=a.current,s=r.current;!i||!s||(i.addEventListener("canplay",()=>i.play(),{once:!0}),i.srcObject=s)};return(0,ft.jsxs)(ft.Fragment,{children:[(0,ft.jsx)("audio",{ref:a,autoPlay:!0}),e.map(i=>(0,ft.jsx)(nl,{track:i,mediaStream:r.current,onTrackAdded:(s,l)=>{t(s,l),o()},onTrackRemoved:(s,l)=>{n(s,l),o()}},i))]})};function nl({mediaStream:e,track:t,onTrackAdded:n,onTrackRemoved:r}){let a=(0,Le.useRef)(n);a.current=n;let o=(0,Le.useRef)(r);o.current=r;let{partyTracks:i}=I(),s=(0,Le.useMemo)(()=>{let[p,u]=t.split("/");return{sessionId:p,trackName:u,location:"remote"}},[t]),l=(0,Le.useMemo)(()=>i.pull(pt(s)),[i,s]),c=re(l);return(0,Le.useEffect)(()=>{if(c)return e.addTrack(c),a.current(t,c),()=>{e.removeTrack(c),o.current(t,c)}},[c,e,t]),null}var En=h(C()),Xa=(0,_t.createContext)({}),Va=({audioTracks:e,children:t})=>{let[n,r]=(0,_t.useState)({});return(0,En.jsxs)(Xa.Provider,{value:n,children:[(0,En.jsx)(Ua,{tracksToPull:e,onTrackAdded:(a,o)=>r(i=>({...i,[a]:o})),onTrackRemoved:a=>{r(o=>{let i={...o};return delete i[a],i})}}),t]})};function rl(){return(0,_t.useContext)(Xa)}function mt(e){let t=rl();return e?t[e]:void 0}function Ja(e){let t=mt(e.user.tracks.audio),n=Lt(t);return(0,ja.useEffect)(()=>{n&&e.recordActivity(e.user)},[n,e]),null}var ae=h(C());function ol(){let{room:{websocket:e}}=I();return(0,ae.jsx)(k,{onClick:()=>e.send(JSON.stringify({type:"disableAi"})),className:"text-xs",displayType:"secondary",children:"Remove AI"})}function Ka(e){let{room:{roomState:{ai:{connectionPending:t,error:n},users:r}}}=I(),a=r.find(o=>o.id==="ai");return(0,ae.jsxs)(ae.Fragment,{children:[n&&(0,ae.jsx)("span",{className:"text-red-800 dark:text-red-500",children:n}),a?(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(ol,{}),(0,ae.jsx)(Oa,{}),(0,ae.jsx)(Ja,{user:a,recordActivity:e.recordActivity})]}):(0,ae.jsx)($a,{children:(0,ae.jsx)(Ln,{asChild:!0,children:(0,ae.jsx)(k,{className:"text-xs flex items-center gap-2",disabled:t,children:(0,ae.jsx)("span",{children:"Invite AI"})})})})]})}var Qa=h(w());var wn=h(w());function Dn(e,t){let[n,r]=(0,wn.useState)(e);return(0,wn.useEffect)(()=>{let a=window.setTimeout(()=>{r(e)},t);return()=>{clearTimeout(a)}},[e,t]),n}var Ge=class{constructor(t,n,r){oe(typeof t=="number","halfLifeMs is not a number"),oe(!isNaN(t),"halfLifeMs can not be NaN"),oe(typeof n=="number","initialValue is not a number"),oe(!isNaN(n),"initialValue can not be NaN"),r!==void 0&&oe(typeof r.now=="function","clock.now is not a function"),this._decay=t,this._ewma=n||0,this._clock=r||Date,this._stamp=typeof n=="number"?this._clock.now():0}insert(t){oe(typeof t=="number","x is not a number"),oe(!isNaN(t),"x can not be NaN");var n=this._clock.now(),r=n-this._stamp;this._stamp=n;var a=Math.pow(2,-r/this._decay);this._ewma=a*this._ewma+(1-a)*t}reset(t){oe(typeof t=="number","x is not a number"),oe(!isNaN(t),"x can not be NaN"),this._stamp=this._clock.now(),this._ewma=t}value(){return this._ewma}};var al=["production","development","test"],il="production",qa=al.find(e=>e===il);oe(qa);var Ya=qa;function Ga(e){let t=new Ge(2e3,0),n=new Ge(2e3,0),r=!1;return dt([e,An(1e3)]).pipe(ke(([a])=>a.getStats()),Cn(),It(([a,o])=>{let i=0,s=0,l=0,c=0,p,u,d;if(o.forEach(m=>{let f=a.get(m.id);if(f){if(m.type==="transport"&&(p=m.selectedCandidatePairId),p&&(u=o.get(p)?.remoteCandidateId),u&&(d=o.get(u).address),d!==void 0&&d!=="141.101.90.0"&&(console.warn("PeerConnection doesn't appear to be connected to anycast 141.101.90.0"),Ya==="production"&&!r&&(alert("You are not connected to CF anycast address"),r=!0)),m.type==="inbound-rtp")s+=m.packetsLost-f.packetsLost,i+=m.packetsReceived-f.packetsReceived;else if(m.type==="outbound-rtp"){let g=m.packetsSent-f.packetsSent,y=Array.from(o.values()).find(E=>E.type==="remote-inbound-rtp"&&E.ssrc===m.ssrc),A=Array.from(a.values()).find(E=>E.type==="remote-inbound-rtp"&&E.ssrc===f.ssrc);y&&A&&g>0&&(l+=m.packetsSent-f.packetsSent,c+=y.packetsLost-A.packetsLost)}}}),i>0){let m=s/(i+s);t.insert(Math.max(0,m))}if(l>0){let m=c/(l+c);n.insert(Math.max(0,m))}return{outboundPacketLossPercentage:n.value(),inboundPacketLossPercentage:t.value()}}))}var Qe=h(C());function sl(){let{partyTracks:e}=I(),t=(0,Qa.useMemo)(()=>Ga(e.peerConnection$),[e.peerConnection$]);return re(t,{inboundPacketLossPercentage:0,outboundPacketLossPercentage:0})}function Za(){let{inboundPacketLossPercentage:e,outboundPacketLossPercentage:t}=sl(),n=Dn(e!==void 0&&t!==void 0&&(e>.05||t>.05),5e3);return e===void 0||t===void 0||!n?null:(0,Qe.jsx)(In,{duration:1/0,children:(0,Qe.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,Qe.jsx)("div",{className:"font-bold",children:(0,Qe.jsxs)(Me.Title,{className:"flex items-center gap-2",children:[(0,Qe.jsx)(x,{type:"SignalSlashIcon"}),"Unstable connection"]})}),(0,Qe.jsx)(Me.Description,{children:"Call quality may be affected."})]})})}var ht=h(C());function za(){let{iceConnectionState:e}=I();return Dn(e==="disconnected",2e3)?(0,ht.jsx)(In,{duration:1/0,children:(0,ht.jsx)("div",{className:"space-y-2 text-sm",children:(0,ht.jsx)("div",{className:"font-bold",children:(0,ht.jsxs)(Me.Title,{className:"flex items-center gap-2",children:[(0,ht.jsx)(x,{type:"WifiIcon"}),"ICE disconnected"]})})})}):null}var Ft=h(C()),Wa=({navigateToFeedbackPage:e,meetingId:t})=>{let n=mn();return(0,Ft.jsx)(Q,{content:"Leave",children:(0,Ft.jsxs)(k,{displayType:"danger",onClick:()=>{let r=new URLSearchParams;t&&r.set("meetingId",t),n(e?`/call-quality-feedback?${r}`:"/")},children:[(0,Ft.jsx)(ue,{children:"Leave"}),(0,Ft.jsx)(x,{type:"phoneXMark"})]})})};var Un=h(w());var jr={};Wn(jr,{Arrow:()=>Vr,CheckboxItem:()=>du,Content:()=>Ur,DropdownMenu:()=>Ir,DropdownMenuArrow:()=>Br,DropdownMenuCheckboxItem:()=>_r,DropdownMenuContent:()=>Er,DropdownMenuGroup:()=>wr,DropdownMenuItem:()=>xr,DropdownMenuItemIndicator:()=>Nr,DropdownMenuLabel:()=>Dr,DropdownMenuPortal:()=>Lr,DropdownMenuRadioGroup:()=>Fr,DropdownMenuRadioItem:()=>kr,DropdownMenuSeparator:()=>Or,DropdownMenuSub:()=>Zi,DropdownMenuSubContent:()=>$r,DropdownMenuSubTrigger:()=>Hr,DropdownMenuTrigger:()=>Tr,Group:()=>uu,Item:()=>Xr,ItemIndicator:()=>hu,Label:()=>pu,Portal:()=>lu,RadioGroup:()=>fu,RadioItem:()=>mu,Root:()=>su,Separator:()=>gu,Sub:()=>vu,SubContent:()=>bu,SubTrigger:()=>yu,Trigger:()=>cu,createDropdownMenuScope:()=>ql});var Y=h(w(),1);var P=h(w(),1);var Z=h(w(),1);var Ze=h(C(),1),dr="rovingFocusGroup.onEntryFocus",cl={bubbles:!1,cancelable:!0},xn="RovingFocusGroup",[fr,ei,ll]=Mn(xn),[ul,mr]=Ke(xn,[ll]),[pl,dl]=ul(xn),ti=Z.forwardRef((e,t)=>(0,Ze.jsx)(fr.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,Ze.jsx)(fr.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,Ze.jsx)(fl,{...e,ref:t})})}));ti.displayName=xn;var fl=Z.forwardRef((e,t)=>{let{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:o,currentTabStopId:i,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:p=!1,...u}=e,d=Z.useRef(null),m=Se(t,d),f=Tn(o),[g=null,y]=Yt({prop:i,defaultProp:s,onChange:l}),[A,E]=Z.useState(!1),V=Tt(c),D=ei(n),ee=Z.useRef(!1),[U,fe]=Z.useState(0);return Z.useEffect(()=>{let j=d.current;if(j)return j.addEventListener(dr,V),()=>j.removeEventListener(dr,V)},[V]),(0,Ze.jsx)(pl,{scope:n,orientation:r,dir:f,loop:a,currentTabStopId:g,onItemFocus:Z.useCallback(j=>y(j),[y]),onItemShiftTab:Z.useCallback(()=>E(!0),[]),onFocusableItemAdd:Z.useCallback(()=>fe(j=>j+1),[]),onFocusableItemRemove:Z.useCallback(()=>fe(j=>j-1),[]),children:(0,Ze.jsx)(Re.div,{tabIndex:A||U===0?-1:0,"data-orientation":r,...u,ref:m,style:{outline:"none",...e.style},onMouseDown:L(e.onMouseDown,()=>{ee.current=!0}),onFocus:L(e.onFocus,j=>{let me=!ee.current;if(j.target===j.currentTarget&&me&&!A){let he=new CustomEvent(dr,cl);if(j.currentTarget.dispatchEvent(he),!he.defaultPrevented){let De=D().filter(Pe=>Pe.focusable),Be=De.find(Pe=>Pe.active),tt=De.find(Pe=>Pe.id===g),At=[Be,tt,...De].filter(Boolean).map(Pe=>Pe.ref.current);oi(At,p)}}ee.current=!1}),onBlur:L(e.onBlur,()=>E(!1))})})}),ni="RovingFocusGroupItem",ri=Z.forwardRef((e,t)=>{let{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:o,...i}=e,s=qe(),l=o||s,c=dl(ni,n),p=c.currentTabStopId===l,u=ei(n),{onFocusableItemAdd:d,onFocusableItemRemove:m}=c;return Z.useEffect(()=>{if(r)return d(),()=>m()},[r,d,m]),(0,Ze.jsx)(fr.ItemSlot,{scope:n,id:l,focusable:r,active:a,children:(0,Ze.jsx)(Re.span,{tabIndex:p?0:-1,"data-orientation":c.orientation,...i,ref:t,onMouseDown:L(e.onMouseDown,f=>{r?c.onItemFocus(l):f.preventDefault()}),onFocus:L(e.onFocus,()=>c.onItemFocus(l)),onKeyDown:L(e.onKeyDown,f=>{if(f.key==="Tab"&&f.shiftKey){c.onItemShiftTab();return}if(f.target!==f.currentTarget)return;let g=gl(f,c.orientation,c.dir);if(g!==void 0){if(f.metaKey||f.ctrlKey||f.altKey||f.shiftKey)return;f.preventDefault();let A=u().filter(E=>E.focusable).map(E=>E.ref.current);if(g==="last")A.reverse();else if(g==="prev"||g==="next"){g==="prev"&&A.reverse();let E=A.indexOf(f.currentTarget);A=c.loop?vl(A,E+1):A.slice(E+1)}setTimeout(()=>oi(A))}})})})});ri.displayName=ni;var ml={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function hl(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function gl(e,t,n){let r=hl(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return ml[r]}function oi(e,t=!1){let n=document.activeElement;for(let r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function vl(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var ai=ti,ii=ri;var S=h(C(),1),hr=["Enter"," "],bl=["ArrowDown","PageUp","Home"],ci=["ArrowUp","PageDown","End"],Pl=[...bl,...ci],Al={ltr:[...hr,"ArrowRight"],rtl:[...hr,"ArrowLeft"]},Cl={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Wt="Menu",[Zt,Sl,Rl]=Mn(Wt),[gt,gr]=Ke(Wt,[Rl,nr,mr]),en=nr(),li=mr(),[ui,ze]=gt(Wt),[Ml,tn]=gt(Wt),pi=e=>{let{__scopeMenu:t,open:n=!1,children:r,dir:a,onOpenChange:o,modal:i=!0}=e,s=en(t),[l,c]=P.useState(null),p=P.useRef(!1),u=Tt(o),d=Tn(a);return P.useEffect(()=>{let m=()=>{p.current=!0,document.addEventListener("pointerdown",f,{capture:!0,once:!0}),document.addEventListener("pointermove",f,{capture:!0,once:!0})},f=()=>p.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",f,{capture:!0}),document.removeEventListener("pointermove",f,{capture:!0})}},[]),(0,S.jsx)(rr,{...s,children:(0,S.jsx)(ui,{scope:t,open:n,onOpenChange:u,content:l,onContentChange:c,children:(0,S.jsx)(Ml,{scope:t,onClose:P.useCallback(()=>u(!1),[u]),isUsingKeyboardRef:p,dir:d,modal:i,children:r})})})};pi.displayName=Wt;var Il="MenuAnchor",vr=P.forwardRef((e,t)=>{let{__scopeMenu:n,...r}=e,a=en(n);return(0,S.jsx)(aa,{...a,...r,ref:t})});vr.displayName=Il;var yr="MenuPortal",[Tl,di]=gt(yr,{forceMount:void 0}),fi=e=>{let{__scopeMenu:t,forceMount:n,children:r,container:a}=e,o=ze(yr,t);return(0,S.jsx)(Tl,{scope:t,forceMount:n,children:(0,S.jsx)(qt,{present:n||o.open,children:(0,S.jsx)(ca,{asChild:!0,container:a,children:r})})})};fi.displayName=yr;var ge="MenuContent",[Ll,br]=gt(ge),mi=P.forwardRef((e,t)=>{let n=di(ge,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=ze(ge,e.__scopeMenu),i=tn(ge,e.__scopeMenu);return(0,S.jsx)(Zt.Provider,{scope:e.__scopeMenu,children:(0,S.jsx)(qt,{present:r||o.open,children:(0,S.jsx)(Zt.Slot,{scope:e.__scopeMenu,children:i.modal?(0,S.jsx)(El,{...a,ref:t}):(0,S.jsx)(wl,{...a,ref:t})})})})}),El=P.forwardRef((e,t)=>{let n=ze(ge,e.__scopeMenu),r=P.useRef(null),a=Se(t,r);return P.useEffect(()=>{let o=r.current;if(o)return ga(o)},[]),(0,S.jsx)(Pr,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:L(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),wl=P.forwardRef((e,t)=>{let n=ze(ge,e.__scopeMenu);return(0,S.jsx)(Pr,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Pr=P.forwardRef((e,t)=>{let{__scopeMenu:n,loop:r=!1,trapFocus:a,onOpenAutoFocus:o,onCloseAutoFocus:i,disableOutsidePointerEvents:s,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:p,onFocusOutside:u,onInteractOutside:d,onDismiss:m,disableOutsideScroll:f,...g}=e,y=ze(ge,n),A=tn(ge,n),E=en(n),V=li(n),D=Sl(n),[ee,U]=P.useState(null),fe=P.useRef(null),j=Se(t,fe,y.onContentChange),me=P.useRef(0),he=P.useRef(""),De=P.useRef(0),Be=P.useRef(null),tt=P.useRef("right"),nt=P.useRef(0),At=f?va:P.Fragment,Pe=f?{as:Wo,allowPinchZoom:!0}:void 0,cn=b=>{let J=he.current+b,M=D().filter(G=>!G.disabled),te=document.activeElement,Ae=M.find(G=>G.ref.current===te)?.textValue,xe=M.map(G=>G.textValue),rt=Xl(xe,J,Ae),_e=M.find(G=>G.textValue===rt)?.ref.current;(function G(Ct){he.current=Ct,window.clearTimeout(me.current),Ct!==""&&(me.current=window.setTimeout(()=>G(""),1e3))})(J),_e&&setTimeout(()=>_e.focus())};P.useEffect(()=>()=>window.clearTimeout(me.current),[]),ma();let R=P.useCallback(b=>tt.current===Be.current?.side&&jl(b,Be.current?.area),[]);return(0,S.jsx)(Ll,{scope:n,searchRef:he,onItemEnter:P.useCallback(b=>{R(b)&&b.preventDefault()},[R]),onItemLeave:P.useCallback(b=>{R(b)||(fe.current?.focus(),U(null))},[R]),onTriggerLeave:P.useCallback(b=>{R(b)&&b.preventDefault()},[R]),pointerGraceTimerRef:De,onPointerGraceIntentChange:P.useCallback(b=>{Be.current=b},[]),children:(0,S.jsx)(At,{...Pe,children:(0,S.jsx)(ha,{asChild:!0,trapped:a,onMountAutoFocus:L(o,b=>{b.preventDefault(),fe.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:(0,S.jsx)(oa,{asChild:!0,disableOutsidePointerEvents:s,onEscapeKeyDown:c,onPointerDownOutside:p,onFocusOutside:u,onInteractOutside:d,onDismiss:m,children:(0,S.jsx)(ai,{asChild:!0,...V,dir:A.dir,orientation:"vertical",loop:r,currentTabStopId:ee,onCurrentTabStopIdChange:U,onEntryFocus:L(l,b=>{A.isUsingKeyboardRef.current||b.preventDefault()}),preventScrollOnEntryFocus:!0,children:(0,S.jsx)(ia,{role:"menu","aria-orientation":"vertical","data-state":Di(y.open),"data-radix-menu-content":"",dir:A.dir,...E,...g,ref:j,style:{outline:"none",...g.style},onKeyDown:L(g.onKeyDown,b=>{let M=b.target.closest("[data-radix-menu-content]")===b.currentTarget,te=b.ctrlKey||b.altKey||b.metaKey,Ae=b.key.length===1;M&&(b.key==="Tab"&&b.preventDefault(),!te&&Ae&&cn(b.key));let xe=fe.current;if(b.target!==xe||!Pl.includes(b.key))return;b.preventDefault();let _e=D().filter(G=>!G.disabled).map(G=>G.ref.current);ci.includes(b.key)&&_e.reverse(),$l(_e)}),onBlur:L(e.onBlur,b=>{b.currentTarget.contains(b.target)||(window.clearTimeout(me.current),he.current="")}),onPointerMove:L(e.onPointerMove,zt(b=>{let J=b.target,M=nt.current!==b.clientX;if(b.currentTarget.contains(J)&&M){let te=b.clientX>nt.current?"right":"left";tt.current=te,nt.current=b.clientX}}))})})})})})})});mi.displayName=ge;var Dl="MenuGroup",Ar=P.forwardRef((e,t)=>{let{__scopeMenu:n,...r}=e;return(0,S.jsx)(Re.div,{role:"group",...r,ref:t})});Ar.displayName=Dl;var xl="MenuLabel",hi=P.forwardRef((e,t)=>{let{__scopeMenu:n,...r}=e;return(0,S.jsx)(Re.div,{...r,ref:t})});hi.displayName=xl;var _n="MenuItem",si="menu.itemSelect",kn=P.forwardRef((e,t)=>{let{disabled:n=!1,onSelect:r,...a}=e,o=P.useRef(null),i=tn(_n,e.__scopeMenu),s=br(_n,e.__scopeMenu),l=Se(t,o),c=P.useRef(!1),p=()=>{let u=o.current;if(!n&&u){let d=new CustomEvent(si,{bubbles:!0,cancelable:!0});u.addEventListener(si,m=>r?.(m),{once:!0}),ta(u,d),d.defaultPrevented?c.current=!1:i.onClose()}};return(0,S.jsx)(gi,{...a,ref:l,disabled:n,onClick:L(e.onClick,p),onPointerDown:u=>{e.onPointerDown?.(u),c.current=!0},onPointerUp:L(e.onPointerUp,u=>{c.current||u.currentTarget?.click()}),onKeyDown:L(e.onKeyDown,u=>{let d=s.searchRef.current!=="";n||d&&u.key===" "||hr.includes(u.key)&&(u.currentTarget.click(),u.preventDefault())})})});kn.displayName=_n;var gi=P.forwardRef((e,t)=>{let{__scopeMenu:n,disabled:r=!1,textValue:a,...o}=e,i=br(_n,n),s=li(n),l=P.useRef(null),c=Se(t,l),[p,u]=P.useState(!1),[d,m]=P.useState("");return P.useEffect(()=>{let f=l.current;f&&m((f.textContent??"").trim())},[o.children]),(0,S.jsx)(Zt.ItemSlot,{scope:n,disabled:r,textValue:a??d,children:(0,S.jsx)(ii,{asChild:!0,...s,focusable:!r,children:(0,S.jsx)(Re.div,{role:"menuitem","data-highlighted":p?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...o,ref:c,onPointerMove:L(e.onPointerMove,zt(f=>{r?i.onItemLeave(f):(i.onItemEnter(f),f.defaultPrevented||f.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:L(e.onPointerLeave,zt(f=>i.onItemLeave(f))),onFocus:L(e.onFocus,()=>u(!0)),onBlur:L(e.onBlur,()=>u(!1))})})})}),_l="MenuCheckboxItem",vi=P.forwardRef((e,t)=>{let{checked:n=!1,onCheckedChange:r,...a}=e;return(0,S.jsx)(Ci,{scope:e.__scopeMenu,checked:n,children:(0,S.jsx)(kn,{role:"menuitemcheckbox","aria-checked":Fn(n)?"mixed":n,...a,ref:t,"data-state":Rr(n),onSelect:L(a.onSelect,()=>r?.(Fn(n)?!0:!n),{checkForDefaultPrevented:!1})})})});vi.displayName=_l;var yi="MenuRadioGroup",[Fl,kl]=gt(yi,{value:void 0,onValueChange:()=>{}}),bi=P.forwardRef((e,t)=>{let{value:n,onValueChange:r,...a}=e,o=Tt(r);return(0,S.jsx)(Fl,{scope:e.__scopeMenu,value:n,onValueChange:o,children:(0,S.jsx)(Ar,{...a,ref:t})})});bi.displayName=yi;var Pi="MenuRadioItem",Ai=P.forwardRef((e,t)=>{let{value:n,...r}=e,a=kl(Pi,e.__scopeMenu),o=n===a.value;return(0,S.jsx)(Ci,{scope:e.__scopeMenu,checked:o,children:(0,S.jsx)(kn,{role:"menuitemradio","aria-checked":o,...r,ref:t,"data-state":Rr(o),onSelect:L(r.onSelect,()=>a.onValueChange?.(n),{checkForDefaultPrevented:!1})})})});Ai.displayName=Pi;var Cr="MenuItemIndicator",[Ci,Nl]=gt(Cr,{checked:!1}),Si=P.forwardRef((e,t)=>{let{__scopeMenu:n,forceMount:r,...a}=e,o=Nl(Cr,n);return(0,S.jsx)(qt,{present:r||Fn(o.checked)||o.checked===!0,children:(0,S.jsx)(Re.span,{...a,ref:t,"data-state":Rr(o.checked)})})});Si.displayName=Cr;var Ol="MenuSeparator",Ri=P.forwardRef((e,t)=>{let{__scopeMenu:n,...r}=e;return(0,S.jsx)(Re.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});Ri.displayName=Ol;var Bl="MenuArrow",Mi=P.forwardRef((e,t)=>{let{__scopeMenu:n,...r}=e,a=en(n);return(0,S.jsx)(sa,{...a,...r,ref:t})});Mi.displayName=Bl;var Sr="MenuSub",[Hl,Ii]=gt(Sr),Ti=e=>{let{__scopeMenu:t,children:n,open:r=!1,onOpenChange:a}=e,o=ze(Sr,t),i=en(t),[s,l]=P.useState(null),[c,p]=P.useState(null),u=Tt(a);return P.useEffect(()=>(o.open===!1&&u(!1),()=>u(!1)),[o.open,u]),(0,S.jsx)(rr,{...i,children:(0,S.jsx)(ui,{scope:t,open:r,onOpenChange:u,content:c,onContentChange:p,children:(0,S.jsx)(Hl,{scope:t,contentId:qe(),triggerId:qe(),trigger:s,onTriggerChange:l,children:n})})})};Ti.displayName=Sr;var Qt="MenuSubTrigger",Li=P.forwardRef((e,t)=>{let n=ze(Qt,e.__scopeMenu),r=tn(Qt,e.__scopeMenu),a=Ii(Qt,e.__scopeMenu),o=br(Qt,e.__scopeMenu),i=P.useRef(null),{pointerGraceTimerRef:s,onPointerGraceIntentChange:l}=o,c={__scopeMenu:e.__scopeMenu},p=P.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return P.useEffect(()=>p,[p]),P.useEffect(()=>{let u=s.current;return()=>{window.clearTimeout(u),l(null)}},[s,l]),(0,S.jsx)(vr,{asChild:!0,...c,children:(0,S.jsx)(gi,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":Di(n.open),...e,ref:bn(t,a.onTriggerChange),onClick:u=>{e.onClick?.(u),!(e.disabled||u.defaultPrevented)&&(u.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:L(e.onPointerMove,zt(u=>{o.onItemEnter(u),!u.defaultPrevented&&!e.disabled&&!n.open&&!i.current&&(o.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{n.onOpenChange(!0),p()},100))})),onPointerLeave:L(e.onPointerLeave,zt(u=>{p();let d=n.content?.getBoundingClientRect();if(d){let m=n.content?.dataset.side,f=m==="right",g=f?-5:5,y=d[f?"left":"right"],A=d[f?"right":"left"];o.onPointerGraceIntentChange({area:[{x:u.clientX+g,y:u.clientY},{x:y,y:d.top},{x:A,y:d.top},{x:A,y:d.bottom},{x:y,y:d.bottom}],side:m}),window.clearTimeout(s.current),s.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(u),u.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:L(e.onKeyDown,u=>{let d=o.searchRef.current!=="";e.disabled||d&&u.key===" "||Al[r.dir].includes(u.key)&&(n.onOpenChange(!0),n.content?.focus(),u.preventDefault())})})})});Li.displayName=Qt;var Ei="MenuSubContent",wi=P.forwardRef((e,t)=>{let n=di(ge,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=ze(ge,e.__scopeMenu),i=tn(ge,e.__scopeMenu),s=Ii(Ei,e.__scopeMenu),l=P.useRef(null),c=Se(t,l);return(0,S.jsx)(Zt.Provider,{scope:e.__scopeMenu,children:(0,S.jsx)(qt,{present:r||o.open,children:(0,S.jsx)(Zt.Slot,{scope:e.__scopeMenu,children:(0,S.jsx)(Pr,{id:s.contentId,"aria-labelledby":s.triggerId,...a,ref:c,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:p=>{i.isUsingKeyboardRef.current&&l.current?.focus(),p.preventDefault()},onCloseAutoFocus:p=>p.preventDefault(),onFocusOutside:L(e.onFocusOutside,p=>{p.target!==s.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:L(e.onEscapeKeyDown,p=>{i.onClose(),p.preventDefault()}),onKeyDown:L(e.onKeyDown,p=>{let u=p.currentTarget.contains(p.target),d=Cl[i.dir].includes(p.key);u&&d&&(o.onOpenChange(!1),s.trigger?.focus(),p.preventDefault())})})})})})});wi.displayName=Ei;function Di(e){return e?"open":"closed"}function Fn(e){return e==="indeterminate"}function Rr(e){return Fn(e)?"indeterminate":e?"checked":"unchecked"}function $l(e){let t=document.activeElement;for(let n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function Ul(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function Xl(e,t,n){let a=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,o=n?e.indexOf(n):-1,i=Ul(e,Math.max(o,0));a.length===1&&(i=i.filter(c=>c!==n));let l=i.find(c=>c.toLowerCase().startsWith(a.toLowerCase()));return l!==n?l:void 0}function Vl(e,t){let{x:n,y:r}=e,a=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){let s=t[o].x,l=t[o].y,c=t[i].x,p=t[i].y;l>r!=p>r&&n<(c-s)*(r-l)/(p-l)+s&&(a=!a)}return a}function jl(e,t){if(!t)return!1;let n={x:e.clientX,y:e.clientY};return Vl(n,t)}function zt(e){return t=>t.pointerType==="mouse"?e(t):void 0}var xi=pi,_i=vr,Fi=fi,ki=mi,Ni=Ar,Oi=hi,Bi=kn,Hi=vi,$i=bi,Ui=Ai,Xi=Si,Vi=Ri,ji=Mi,Ji=Ti,Ki=Li,qi=wi;var q=h(C(),1),Mr="DropdownMenu",[Kl,ql]=Ke(Mr,[gr]),ie=gr(),[Yl,Yi]=Kl(Mr),Ir=e=>{let{__scopeDropdownMenu:t,children:n,dir:r,open:a,defaultOpen:o,onOpenChange:i,modal:s=!0}=e,l=ie(t),c=Y.useRef(null),[p=!1,u]=Yt({prop:a,defaultProp:o,onChange:i});return(0,q.jsx)(Yl,{scope:t,triggerId:qe(),triggerRef:c,contentId:qe(),open:p,onOpenChange:u,onOpenToggle:Y.useCallback(()=>u(d=>!d),[u]),modal:s,children:(0,q.jsx)(xi,{...l,open:p,onOpenChange:u,dir:r,modal:s,children:n})})};Ir.displayName=Mr;var Gi="DropdownMenuTrigger",Tr=Y.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,disabled:r=!1,...a}=e,o=Yi(Gi,n),i=ie(n);return(0,q.jsx)(_i,{asChild:!0,...i,children:(0,q.jsx)(Re.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:bn(t,o.triggerRef),onPointerDown:L(e.onPointerDown,s=>{!r&&s.button===0&&s.ctrlKey===!1&&(o.onOpenToggle(),o.open||s.preventDefault())}),onKeyDown:L(e.onKeyDown,s=>{r||(["Enter"," "].includes(s.key)&&o.onOpenToggle(),s.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(s.key)&&s.preventDefault())})})})});Tr.displayName=Gi;var Gl="DropdownMenuPortal",Lr=e=>{let{__scopeDropdownMenu:t,...n}=e,r=ie(t);return(0,q.jsx)(Fi,{...r,...n})};Lr.displayName=Gl;var Qi="DropdownMenuContent",Er=Y.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,a=Yi(Qi,n),o=ie(n),i=Y.useRef(!1);return(0,q.jsx)(ki,{id:a.contentId,"aria-labelledby":a.triggerId,...o,...r,ref:t,onCloseAutoFocus:L(e.onCloseAutoFocus,s=>{i.current||a.triggerRef.current?.focus(),i.current=!1,s.preventDefault()}),onInteractOutside:L(e.onInteractOutside,s=>{let l=s.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,p=l.button===2||c;(!a.modal||p)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Er.displayName=Qi;var Ql="DropdownMenuGroup",wr=Y.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,a=ie(n);return(0,q.jsx)(Ni,{...a,...r,ref:t})});wr.displayName=Ql;var Zl="DropdownMenuLabel",Dr=Y.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,a=ie(n);return(0,q.jsx)(Oi,{...a,...r,ref:t})});Dr.displayName=Zl;var zl="DropdownMenuItem",xr=Y.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,a=ie(n);return(0,q.jsx)(Bi,{...a,...r,ref:t})});xr.displayName=zl;var Wl="DropdownMenuCheckboxItem",_r=Y.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,a=ie(n);return(0,q.jsx)(Hi,{...a,...r,ref:t})});_r.displayName=Wl;var eu="DropdownMenuRadioGroup",Fr=Y.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,a=ie(n);return(0,q.jsx)($i,{...a,...r,ref:t})});Fr.displayName=eu;var tu="DropdownMenuRadioItem",kr=Y.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,a=ie(n);return(0,q.jsx)(Ui,{...a,...r,ref:t})});kr.displayName=tu;var nu="DropdownMenuItemIndicator",Nr=Y.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,a=ie(n);return(0,q.jsx)(Xi,{...a,...r,ref:t})});Nr.displayName=nu;var ru="DropdownMenuSeparator",Or=Y.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,a=ie(n);return(0,q.jsx)(Vi,{...a,...r,ref:t})});Or.displayName=ru;var ou="DropdownMenuArrow",Br=Y.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,a=ie(n);return(0,q.jsx)(ji,{...a,...r,ref:t})});Br.displayName=ou;var Zi=e=>{let{__scopeDropdownMenu:t,children:n,open:r,onOpenChange:a,defaultOpen:o}=e,i=ie(t),[s=!1,l]=Yt({prop:r,defaultProp:o,onChange:a});return(0,q.jsx)(Ji,{...i,open:s,onOpenChange:l,children:n})},au="DropdownMenuSubTrigger",Hr=Y.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,a=ie(n);return(0,q.jsx)(Ki,{...a,...r,ref:t})});Hr.displayName=au;var iu="DropdownMenuSubContent",$r=Y.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,a=ie(n);return(0,q.jsx)(qi,{...a,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});$r.displayName=iu;var su=Ir,cu=Tr,lu=Lr,Ur=Er,uu=wr,pu=Dr,Xr=xr,du=_r,fu=Fr,mu=kr,hu=Nr,gu=Or,Vr=Br,vu=Zi,yu=Hr,bu=$r;var Nn=h(w());var On=h(C()),zi=(0,Nn.forwardRef)(({className:e,...t},n)=>(0,On.jsx)(Vr,{ref:n,className:F("fill-white dark:fill-zinc-600",e),...t}));zi.displayName="Arrow";var Wi=(0,Nn.forwardRef)(({className:e,...t},n)=>(0,On.jsx)(Ur,{ref:n,className:F("bg-white","dark:bg-zinc-600","rounded-md","p-1","space-y-1","shadow-lg","dark:shadow-none","will-change-[opacity,transform]","data-[side=top]:animate-slideDownAndFade","data-[side=right]:animate-slideLeftAndFade","data-[side=bottom]:animate-slideUpAndFade","data-[side=left]:animate-slideRightAndFade",e),...t}));Wi.displayName="Content";var es=(0,Nn.forwardRef)(({className:e,...t},n)=>(0,On.jsx)(Xr,{ref:n,className:F("group","text-base","leading-none","text-zinc-800","dark:text-zinc-200","rounded","flex","items-center","h-6","py-6 md:py-5","relative","px-4","select-none","outline-none","data-[disabled]:text-zinc-600","data-[disabled]:cursor-not-allowed","dark:data-[disabled]:text-zinc-400","data-[highlighted]:bg-orange-500","data-[highlighted]:text-white",e),...t}));es.displayName="Item";var Ee={...jr,Arrow:zi,Content:Wi,Item:es};function Ne(e,t){if(!t)return;let n=new URL(t),r=+new Date,a=r-36e5;return n.searchParams.set("start",(a*1e3).toString()),n.searchParams.set("end",(r*1e3).toString()),n.searchParams.set("tags",JSON.stringify({"peer.SessionID":e})),n.toString()}var oo={};Wn(oo,{Action:()=>xu,AlertDialog:()=>Jr,AlertDialogAction:()=>zr,AlertDialogCancel:()=>Wr,AlertDialogContent:()=>Gr,AlertDialogDescription:()=>Zr,AlertDialogOverlay:()=>Yr,AlertDialogPortal:()=>qr,AlertDialogTitle:()=>Qr,AlertDialogTrigger:()=>Kr,Cancel:()=>_u,Content:()=>to,Description:()=>ro,Overlay:()=>eo,Portal:()=>Du,Root:()=>Eu,Title:()=>no,Trigger:()=>wu,createAlertDialogScope:()=>Au});var de=h(w(),1);var ce=h(C(),1),ts="AlertDialog",[Pu,Au]=Ke(ts,[or]),Ue=or(),Jr=e=>{let{__scopeAlertDialog:t,...n}=e,r=Ue(t);return(0,ce.jsx)(ba,{...r,...n,modal:!0})};Jr.displayName=ts;var Cu="AlertDialogTrigger",Kr=de.forwardRef((e,t)=>{let{__scopeAlertDialog:n,...r}=e,a=Ue(n);return(0,ce.jsx)(Pa,{...a,...r,ref:t})});Kr.displayName=Cu;var Su="AlertDialogPortal",qr=e=>{let{__scopeAlertDialog:t,...n}=e,r=Ue(t);return(0,ce.jsx)(Aa,{...r,...n})};qr.displayName=Su;var Ru="AlertDialogOverlay",Yr=de.forwardRef((e,t)=>{let{__scopeAlertDialog:n,...r}=e,a=Ue(n);return(0,ce.jsx)(Ca,{...a,...r,ref:t})});Yr.displayName=Ru;var kt="AlertDialogContent",[Mu,Iu]=Pu(kt),Gr=de.forwardRef((e,t)=>{let{__scopeAlertDialog:n,children:r,...a}=e,o=Ue(n),i=de.useRef(null),s=Se(t,i),l=de.useRef(null);return(0,ce.jsx)(ya,{contentName:kt,titleName:ns,docsSlug:"alert-dialog",children:(0,ce.jsx)(Mu,{scope:n,cancelRef:l,children:(0,ce.jsxs)(Sa,{role:"alertdialog",...o,...a,ref:s,onOpenAutoFocus:L(a.onOpenAutoFocus,c=>{c.preventDefault(),l.current?.focus({preventScroll:!0})}),onPointerDownOutside:c=>c.preventDefault(),onInteractOutside:c=>c.preventDefault(),children:[(0,ce.jsx)(ea,{children:r}),(0,ce.jsx)(Lu,{contentRef:i})]})})})});Gr.displayName=kt;var ns="AlertDialogTitle",Qr=de.forwardRef((e,t)=>{let{__scopeAlertDialog:n,...r}=e,a=Ue(n);return(0,ce.jsx)(Ra,{...a,...r,ref:t})});Qr.displayName=ns;var rs="AlertDialogDescription",Zr=de.forwardRef((e,t)=>{let{__scopeAlertDialog:n,...r}=e,a=Ue(n);return(0,ce.jsx)(Ma,{...a,...r,ref:t})});Zr.displayName=rs;var Tu="AlertDialogAction",zr=de.forwardRef((e,t)=>{let{__scopeAlertDialog:n,...r}=e,a=Ue(n);return(0,ce.jsx)(ar,{...a,...r,ref:t})});zr.displayName=Tu;var os="AlertDialogCancel",Wr=de.forwardRef((e,t)=>{let{__scopeAlertDialog:n,...r}=e,{cancelRef:a}=Iu(os,n),o=Ue(n),i=Se(t,a);return(0,ce.jsx)(ar,{...o,...r,ref:i})});Wr.displayName=os;var Lu=({contentRef:e})=>{let t=`\`${kt}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${kt}\` by passing a \`${rs}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${kt}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return de.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},Eu=Jr,wu=Kr,Du=qr,eo=Yr,to=Gr,xu=zr,_u=Wr,no=Qr,ro=Zr;var nn=h(w());var Nt=h(C()),as=(0,nn.forwardRef)(({className:e,...t},n)=>(0,Nt.jsx)(eo,{ref:n,className:F("fixed inset-0 bg-black opacity-40",e),...t}));as.displayName="Overlay";var is=(0,nn.forwardRef)(({className:e,children:t,...n},r)=>(0,Nt.jsx)(to,{ref:r,className:F("fixed","rounded-lg","top-1/2","left-1/2","-translate-x-1/2","-translate-y-1/2","min-w-[min(400px,95vw)]","max-w-[95vw]","max-h-[85vh]","overflow-y-auto","p-6","bg-inherit","shadow-xl","dark:shadow-none"),...n,children:t}));is.displayName="Content";var ss=(0,nn.forwardRef)(({className:e,...t},n)=>(0,Nt.jsx)(no,{ref:n,className:F("text-zinc-800 dark:text-zinc-200 m-0 text-base font-medium",e),...t}));ss.displayName="Title";var cs=(0,nn.forwardRef)(({className:e,...t},n)=>(0,Nt.jsx)(ro,{ref:n,className:F("text-zinc-500 dark:text-zinc-400 mt-4 mb-5 text-sm leading-normal",e),...t}));cs.displayName="Description";var Fu=({children:e,className:t})=>(0,Nt.jsx)("div",{className:F("flex justify-end gap-4",t),children:e}),we={...oo,Overlay:as,Content:is,Title:ss,Description:cs,Actions:Fu};var $=h(C()),Bn=({user:e,displayType:t="secondary",mutedDisplayType:n="danger"})=>{let{room:r}=I(),{data:a}=Ye(e.name);return e.tracks.audioUnavailable?(0,$.jsx)(Q,{content:"Mic is unavailable. User cannot unmute.",children:(0,$.jsxs)(k,{disabled:!0,displayType:"secondary",children:[(0,$.jsx)(x,{type:"micOff",className:"text-red-700 dark:text-red-400"}),(0,$.jsx)(ue,{children:"User's mic is unavailable, cannot unmute."})]})}):(0,$.jsxs)(we.Root,{children:[e.tracks.audioEnabled?(0,$.jsx)(Q,{content:`Mute ${a?.displayName}`,children:(0,$.jsx)(we.Trigger,{asChild:!0,children:(0,$.jsx)(k,{displayType:t,disabled:!e.tracks.audioEnabled,children:(0,$.jsx)(x,{type:"micOn"})})})}):(0,$.jsx)(Q,{content:"Cannot unmute",children:(0,$.jsx)(k,{displayType:n,disabled:!0,children:(0,$.jsx)(x,{type:"micOff"})})}),(0,$.jsxs)(we.Portal,{children:[(0,$.jsx)(we.Overlay,{}),(0,$.jsxs)(we.Content,{onCloseAutoFocus:o=>o.preventDefault(),children:[(0,$.jsxs)(we.Title,{children:["Mute ",a?.displayName]}),(0,$.jsx)(we.Description,{children:"They will need to unmute themselves to be heard again."}),(0,$.jsxs)(we.Actions,{children:[(0,$.jsx)(we.Cancel,{asChild:!0,children:(0,$.jsx)(k,{className:"text-sm",displayType:"secondary",children:"Cancel"})}),(0,$.jsx)(we.Action,{asChild:!0,children:(0,$.jsx)(k,{onClick:()=>{r.websocket.send(JSON.stringify({type:"muteUser",id:e.id}))},className:"text-sm",displayType:"danger",children:"Mute"})})]})]})]})]})};var ao=h(C());function Ot({children:e,className:t,href:n,...r}){return n===void 0?(0,ao.jsx)("span",{className:t,children:e}):(0,ao.jsx)("a",{href:n,className:F("no-underline hover:underline",t),...r,children:e})}var X=h(C()),ls=({user:e,audioTrack:t})=>{let{traceLink:n}=I(),{data:r}=Ye(e.name);return(0,X.jsxs)("li",{className:"flex items-center gap-4 text-base h-9",children:[(0,X.jsx)("div",{className:"mr-auto overflow-hidden whitespace-nowrap text-ellipsis",children:(0,X.jsx)(Ot,{href:e.transceiverSessionId?Ne(e.transceiverSessionId,n):void 0,target:"_blank",rel:"noopener noreferrer",children:r?.displayName})}),t&&e.tracks.audioEnabled&&(0,X.jsx)("div",{className:"px-5",children:(0,X.jsx)(Rn,{audioTrack:t})}),(0,X.jsx)(Bn,{user:e})]})},ku=({user:e})=>{let t=mt(e.tracks.audio);return(0,X.jsx)(ls,{user:e,audioTrack:t})},Hn=e=>`${e} Participant${e>1?"s":""}`,us=({className:e,...t})=>{let{room:{otherUsers:n}}=I();return(0,X.jsx)(io,{...t,children:(0,X.jsx)(Q,{content:Hn(n.length+1),children:(0,X.jsx)(Ln,{asChild:!0,children:(0,X.jsx)(k,{className:F("relative",e),displayType:"secondary",children:(0,X.jsx)(x,{type:"userGroup"})})})})})},io=({children:e,otherUsers:t,identity:n,open:r,onOpenChange:a})=>{let{userMedia:o}=I();return(0,X.jsxs)(Dt,{open:r,onOpenChange:a,children:[e,(0,X.jsxs)(xt,{children:[(0,X.jsx)(Et,{}),(0,X.jsx)(wt,{children:(0,X.jsxs)("div",{className:"space-y-4",children:[(0,X.jsx)("h2",{className:"text-xl font-bold",children:Hn(t.length+1)}),(0,X.jsxs)("ul",{className:"space-y-2",children:[n&&(0,X.jsx)(ls,{user:n,audioTrack:o.audioStreamTrack,children:n.name}),t.map(i=>(0,X.jsx)(ku,{user:i},i.id))]})]})})]})]})};var We=h(w());function so(e=2e3){let[t,n]=(0,We.useState)(!1),r=(0,We.useRef)(-1),a=(0,We.useCallback)(o=>{navigator.clipboard.writeText(o),n(!0),clearTimeout(r.current),r.current=window.setTimeout(()=>{n(!1)},e)},[e]);return(0,We.useEffect)(()=>()=>{clearTimeout(r.current)},[]),[t,a]}var ps=h(w());var ds=h(C()),$n=(0,ps.forwardRef)(({className:e,...t},n)=>(0,ds.jsx)("textarea",{ref:n,className:F("bg-zinc-50 dark:bg-zinc-600 text-base border-2 border-zinc-500 w-full resize-none block p-2 rounded",e),...t}));$n.displayName="TextArea";var B=h(C()),fs=({onOpenChange:e})=>(0,B.jsx)(Dt,{open:!0,onOpenChange:e,children:(0,B.jsxs)(xt,{children:[(0,B.jsx)(Et,{}),(0,B.jsx)(wt,{children:(0,B.jsx)(Nu,{})})]})}),Nu=()=>{let{Form:e,data:t,state:n}=Zo(),{room:r,roomHistory:a}=I(),{roomName:o}=hn(),{identity:i}=r,s={roomName:o,identity:i,roomHistory:a,url:typeof location<"u"?location.href:void 0},[l,c]=so(),p=JSON.stringify(s,null,2);return t?(0,B.jsxs)("div",{className:"space-y-4",children:[(0,B.jsx)(ir,{children:"Thank you!"}),(0,B.jsx)(sr,{children:"Your report has been submitted!"})]}):(0,B.jsxs)("div",{className:"space-y-4",children:[(0,B.jsx)(ir,{children:"Report a bug"}),(0,B.jsx)(sr,{children:"The Calls team will be notified with tracing details."}),(0,B.jsxs)("details",{className:"cursor-pointer",children:[(0,B.jsx)("summary",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:"Debug Info (included automatically)"}),(0,B.jsxs)("div",{className:"space-y-4",children:[(0,B.jsx)("div",{}),(0,B.jsx)(k,{className:"text-sm",onClick:()=>{c(p)},children:l?"Copied!":"Copy"}),(0,B.jsx)($n,{rows:10,readOnly:!0,defaultValue:p})]})]}),(0,B.jsxs)(e,{method:"post",action:"/api/bugReport",children:[(0,B.jsxs)("div",{className:"space-y-4",children:[(0,B.jsx)(Ia,{className:"font-bold",children:"Description"}),(0,B.jsx)($n,{name:"description",rows:8})]}),(0,B.jsx)("input",{name:"info",type:"hidden",value:JSON.stringify(s)}),(0,B.jsx)(k,{className:"mt-4 text-sm",type:"submit",disabled:n==="submitting",children:n==="submitting"?"Submitting...":"Submit"})]})]})};var N=h(C()),ms=({bugReportsEnabled:e})=>{let{room:{otherUsers:t,identity:n},dataSaverMode:r,setDataSaverMode:a}=I(),[o,i]=(0,Un.useState)(!1),[s,l]=(0,Un.useState)(!1),[c,p]=(0,Un.useState)(!1),u=La();return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(Ee.Root,{children:[(0,N.jsx)(Ee.Trigger,{asChild:!0,children:(0,N.jsxs)(k,{displayType:"secondary",children:[(0,N.jsx)(ue,{children:"More options"}),(0,N.jsx)(x,{type:"EllipsisVerticalIcon"})]})}),(0,N.jsx)(Ee.Portal,{children:(0,N.jsxs)(Ee.Content,{sideOffset:5,children:[(0,N.jsxs)(Ee.Item,{onSelect:()=>a(!r),children:[(0,N.jsx)(x,{type:"WifiIcon",className:"mr-2"}),r?"Disable Data Saver":"Enable Data Saver"]}),(0,N.jsxs)(Ee.Item,{onSelect:()=>navigator.clipboard.writeText(u),children:[(0,N.jsx)(x,{type:"ClipboardDocumentIcon",className:"mr-2"}),"Copy URL"]}),(0,N.jsxs)(Ee.Item,{onSelect:()=>{i(!0)},children:[(0,N.jsx)(x,{type:"cog",className:"mr-2"}),"Settings"]}),e&&(0,N.jsxs)(Ee.Item,{onSelect:()=>{l(!0)},children:[(0,N.jsx)(x,{type:"bug",className:"mr-2"}),"Report bug"]}),(0,N.jsxs)(Ee.Item,{className:"md:hidden",onSelect:()=>{p(!0)},children:[(0,N.jsx)(x,{type:"userGroup",className:"mr-2"}),Hn(t.length+1)]}),(0,N.jsx)(Ee.Arrow,{})]})})]}),o&&(0,N.jsx)(Ta,{open:!0,onOpenChange:i}),e&&s&&(0,N.jsx)(fs,{onOpenChange:l}),c&&(0,N.jsx)(io,{otherUsers:t,identity:n,open:!0,onOpenChange:p})]})};var Kn=h(w());function co(e){if(e.constructor!==Array)throw new TypeError("Expected array.");if(e.length===16)return e;if(e.length===6){var t=Bt();return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}throw new RangeError("Expected array with either 6 or 16 values.")}function Bt(){for(var e=[],t=0;t<16;t++)t%5==0?e.push(1):e.push(0);return e}function hs(e,t){for(var n=co(e),r=co(t),a=[],o=0;o<4;o++)for(var i=[n[o],n[o+4],n[o+8],n[o+12]],s=0;s<4;s++){var l=s*4,c=[r[l],r[l+1],r[l+2],r[l+3]],p=i[0]*c[0]+i[1]*c[1]+i[2]*c[2]+i[3]*c[3];a[o+l]=p}return a}function gs(e){if(typeof e=="string"){var t=e.match(/matrix(3d)?\(([^)]+)\)/);if(t){var n=t[2].split(", ").map(parseFloat);return co(n)}}return Bt()}function vs(e){var t=Bt();return t[0]=e,t}function ys(e){var t=Bt();return t[5]=e,t}function bs(e){var t=Bt();return t[12]=e,t}function Ps(e){var t=Bt();return t[13]=e,t}var Xn=function(e){return typeof e=="number"},Ts=function(e){return typeof e=="function"},Ls=function(e){return Object.prototype.toString.call(e)==="[object Object]"},Ht=function(e){return Array.prototype.slice.apply(e)},Es=function(e){var t=e.reduce(function(n,r){return n[r]=(n[r]||0)+1,n},{});return Object.keys(t).filter(function(n){return t[n]>1})};function et(e){return[].slice.call(arguments,1).forEach(function(t){if(t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}),e}var uo,po=function(e,t,n){return e+(t-e)*n},mo={__proto__:null,isNumber:Xn,isFunction:Ts,isObject:Ls,toArray:Ht,getDuplicateValsAsStrings:Es,assign:et,tweenProp:po},ho="data-flip-id",go="data-inverse-flip-id",vo="data-portal-key",ws="data-exit-container",rn={__proto__:null,DATA_FLIP_ID:ho,DATA_INVERSE_FLIP_ID:go,DATA_FLIP_COMPONENT_ID:"data-flip-component-id",DATA_FLIP_CONFIG:"data-flip-config",DATA_PORTAL_KEY:vo,DATA_EXIT_CONTAINER:ws},fo={noWobble:{stiffness:200,damping:26},gentle:{stiffness:120,damping:14},veryGentle:{stiffness:130,damping:17},wobbly:{stiffness:180,damping:12},stiff:{stiffness:260,damping:26}},As=function(e){return Ls(e)?e:Object.keys(fo).indexOf(e)>-1?fo[e]:{}};typeof window<"u"&&(uo=window.requestAnimationFrame);var Bu=uo=uo||function(e){window.setTimeout(e,1e3/60)},Hu=Date.now(),$u=typeof performance=="object"&&typeof performance.now=="function"?function(){return performance.now()}:function(){return Date.now()-Hu};function Ds(e,t){var n=e.indexOf(t);n!==-1&&e.splice(n,1)}var Uu=function(){function e(){}return e.prototype.run=function(){var t=this;Bu(function(){t.springSystem.loop($u())})},e}(),lo=function(){this.position=0,this.velocity=0},Xu=0,ve=.001,Vu=function(){function e(n){this._id="s"+Xu++,this._springSystem=n,this.listeners=[],this._startValue=0,this._currentState=new lo,this._displacementFromRestThreshold=.001,this._endValue=0,this._overshootClampingEnabled=!1,this._previousState=new lo,this._restSpeedThreshold=.001,this._tempState=new lo,this._timeAccumulator=0,this._wasAtRest=!0,this._cachedSpringConfig={}}var t=e.prototype;return t.getId=function(){return this._id},t.destroy=function(){this.listeners=[],this._springSystem.deregisterSpring(this)},t.setSpringConfig=function(n){return this._springConfig=n,this},t.getCurrentValue=function(){return this._currentState.position},t.getDisplacementDistanceForState=function(n){return Math.abs(this._endValue-n.position)},t.setEndValue=function(n){if(n===this._endValue)return this;if(this.prevEndValue=n,this._endValue===n&&this.isAtRest())return this;this._startValue=this.getCurrentValue(),this._endValue=n,this._springSystem.activateSpring(this.getId());for(var r=0,a=this.listeners.length;r<a;r++){var o=this.listeners[r].onSpringEndStateChange;o&&o(this)}return this},t.setVelocity=function(n){return n===this._currentState.velocity||(this._currentState.velocity=n,this._springSystem.activateSpring(this.getId())),this},t.setCurrentValue=function(n){this._startValue=n,this._currentState.position=n;for(var r=0,a=this.listeners.length;r<a;r++){var o=this.listeners[r];o.onSpringUpdate&&o.onSpringUpdate(this)}return this},t.setAtRest=function(){return this._endValue=this._currentState.position,this._tempState.position=this._currentState.position,this._currentState.velocity=0,this},t.setOvershootClampingEnabled=function(n){return this._overshootClampingEnabled=n,this},t.isOvershooting=function(){var n=this._startValue,r=this._endValue;return this._springConfig.tension>0&&(n<r&&this.getCurrentValue()>r||n>r&&this.getCurrentValue()<r)},t.advance=function(n,r){var a=this.isAtRest();if(!a||!this._wasAtRest){var o=r;r>.064&&(o=.064),this._timeAccumulator+=o;for(var i,s,l,c,p,u,d=this._springConfig.tension,m=this._springConfig.friction,f=this._currentState.position,g=this._currentState.velocity,y=this._tempState.position,A=this._tempState.velocity;this._timeAccumulator>=ve;)this._timeAccumulator-=ve,this._timeAccumulator<ve&&(this._previousState.position=f,this._previousState.velocity=g),s=d*(this._endValue-y)-m*g,c=d*(this._endValue-(y=f+(i=g)*ve*.5))-m*(A=g+s*ve*.5),u=d*(this._endValue-(y=f+(l=A)*ve*.5))-m*(A=g+c*ve*.5),y=f+(p=A)*ve,f+=1/6*(i+2*(l+p)+(A=g+u*ve))*ve,g+=1/6*(s+2*(c+u)+(d*(this._endValue-y)-m*A))*ve;this._tempState.position=y,this._tempState.velocity=A,this._currentState.position=f,this._currentState.velocity=g,this._timeAccumulator>0&&this._interpolate(this._timeAccumulator/ve),(this.isAtRest()||this._overshootClampingEnabled&&this.isOvershooting())&&(this._springConfig.tension>0?(this._startValue=this._endValue,this._currentState.position=this._endValue):(this._endValue=this._currentState.position,this._startValue=this._endValue),this.setVelocity(0),a=!0);var E=!1;this._wasAtRest&&(this._wasAtRest=!1,E=!0);var V=!1;a&&(this._wasAtRest=!0,V=!0),this.notifyPositionUpdated(E,V)}},t.notifyPositionUpdated=function(n,r){var a=this;this.listeners.filter(Boolean).forEach(function(o){n&&o.onSpringActivate&&!a._onActivateCalled&&(o.onSpringActivate(a),a._onActivateCalled=!0),o.onSpringUpdate&&o.onSpringUpdate(a),r&&o.onSpringAtRest&&o.onSpringAtRest(a)})},t.systemShouldAdvance=function(){return!this.isAtRest()||!this.wasAtRest()},t.wasAtRest=function(){return this._wasAtRest},t.isAtRest=function(){return Math.abs(this._currentState.velocity)<this._restSpeedThreshold&&(this.getDisplacementDistanceForState(this._currentState)<=this._displacementFromRestThreshold||this._springConfig.tension===0)},t._interpolate=function(n){this._currentState.position=this._currentState.position*n+this._previousState.position*(1-n),this._currentState.velocity=this._currentState.velocity*n+this._previousState.velocity*(1-n)},t.addListener=function(n){return this.listeners.push(n),this},t.addOneTimeListener=function(n){var r=this;return Object.keys(n).forEach(function(a){var o;n[a]=(o=n[a],function(){o.apply(void 0,[].slice.call(arguments)),r.removeListener(n)})}),this.listeners.push(n),this},t.removeListener=function(n){return Ds(this.listeners,n),this},e}(),xs=function(){function e(n){this.looper=n||new Uu,this.looper.springSystem=this,this.listeners=[],this._activeSprings=[],this._idleSpringIndices=[],this._isIdle=!0,this._lastTimeMillis=-1,this._springRegistry={}}var t=e.prototype;return t.createSpring=function(n,r){return this.createSpringWithConfig({tension:n,friction:r})},t.createSpringWithConfig=function(n){var r=new Vu(this);return this.registerSpring(r),r.setSpringConfig(n),r},t.getIsIdle=function(){return this._isIdle},t.registerSpring=function(n){this._springRegistry[n.getId()]=n},t.deregisterSpring=function(n){Ds(this._activeSprings,n),delete this._springRegistry[n.getId()]},t.advance=function(n,r){for(var a=this;this._idleSpringIndices.length>0;)this._idleSpringIndices.pop();for(this._activeSprings.filter(Boolean).forEach(function(i){i.systemShouldAdvance()?i.advance(n/1e3,r/1e3):a._idleSpringIndices.push(a._activeSprings.indexOf(i))});this._idleSpringIndices.length>0;){var o=this._idleSpringIndices.pop();o>=0&&this._activeSprings.splice(o,1)}},t.loop=function(n){var r;this._lastTimeMillis===-1&&(this._lastTimeMillis=n-1);var a=n-this._lastTimeMillis;this._lastTimeMillis=n;var o=0,i=this.listeners.length;for(o=0;o<i;o++)(r=this.listeners[o]).onBeforeIntegrate&&r.onBeforeIntegrate(this);for(this.advance(n,a),this._activeSprings.length===0&&(this._isIdle=!0,this._lastTimeMillis=-1),o=0;o<i;o++)(r=this.listeners[o]).onAfterIntegrate&&r.onAfterIntegrate(this);this._isIdle||this.looper.run()},t.activateSpring=function(n){var r=this._springRegistry[n];this._activeSprings.indexOf(r)===-1&&this._activeSprings.push(r),this.getIsIdle()&&(this._isIdle=!1,this.looper.run())},e}(),ju=new xs,_s=function(e){var t=e.springConfig,n=t.overshootClamping,r=e.getOnUpdateFunc,a=e.onAnimationEnd,o=e.onSpringActivate,i=ju.createSpring(t.stiffness,t.damping);i.setOvershootClampingEnabled(!!n);var s={onSpringActivate:o,onSpringAtRest:function(){i.destroy(),a()},onSpringUpdate:r({spring:i,onAnimationEnd:a})};return i.addListener(s),i},Cs=function(e){var t=_s(e);return t.setEndValue(1),t},Ss=function(e,t){if(t===void 0&&(t={}),e&&e.length){t.reverse&&e.reverse();var n,r=typeof(n=t.speed)!="number"?1.1:1+Math.min(Math.max(5*n,0),5),a=1/Math.max(Math.min(e.length,100),10),o=e.map(function(i,s){var l=i.getOnUpdateFunc;return i.getOnUpdateFunc=function(c){var p=l(c);return function(u){var d=u.getCurrentValue();(d=d<.01?0:d>.99?1:d)>=a&&o[s+1]&&o[s+1](Math.max(Math.min(d*r,1),0)),p(u)}},i}).map(function(i){var s=_s(i);if(s)return s.setEndValue.bind(s)}).filter(Boolean);o[0]&&o[0](1)}},Rs=function(e){return[0,1,4,5,12,13].map(function(t){return e[t]})},Ms=function(e){return e.top<window.innerHeight&&e.bottom>0&&e.left<window.innerWidth&&e.right>0};function Is(e){return JSON.parse(e.dataset.flipConfig||"{}")}var Fs=function(e,t){var n;return et(e,((n={})[t[0]]=t[1],n))},ks=function(e,t){return Ht(t?document.querySelectorAll("["+vo+'="'+t+'"]'):e.querySelectorAll("["+ho+"]"))},Ns=function(e){return e.map(function(t){return[t,t.getBoundingClientRect()]})},Ju=!0;var Os=function(e){var t=e.cachedOrderedFlipIds,n=t===void 0?[]:t,r=e.inProgressAnimations,a=r===void 0?{}:r,o=e.flippedElementPositionsBeforeUpdate,i=o===void 0?{}:o,s=e.flipCallbacks,l=s===void 0?{}:s,c=e.containerEl,p=e.applyTransformOrigin,u=e.spring,d=e.debug,m=e.portalKey,f=e.staggerConfig,g=f===void 0?{}:f,y=e.decisionData,A=y===void 0?{}:y,E=e.handleEnterUpdateDelete,V=e.onComplete,D=e.onStart;if(Ju&&!window.matchMedia("(prefers-reduced-motion: reduce)").matches){var ee,U=Ns(ks((ee={element:c,portalKey:m}).element,ee.portalKey)).map(function(R){var b=R[0],J=R[1],M=window.getComputedStyle(b);return[b.dataset.flipId,{element:b,rect:J,opacity:parseFloat(M.opacity),transform:M.transform}]}).reduce(Fs,{}),fe=function(R){var b=R.containerEl,J=R.portalKey;return J?function(M){return function(te){return Ht(document.querySelectorAll("["+vo+'="'+M+'"]'+te))}}(J):b?function(M){var te=Math.random().toFixed(5);return M.dataset.flipperId=te,function(Ae){return Ht(M.querySelectorAll('[data-flipper-id="'+te+'"] '+Ae))}}(b):function(){return[]}}({containerEl:c,portalKey:m}),j=function(R){return function(b){return R("["+ho+'="'+b+'"]')[0]}}(fe),me=function(R){return i[R]&&U[R]},he=Object.keys(i).concat(Object.keys(U)).filter(function(R){return!me(R)}),De={flipCallbacks:l,getElement:j,flippedElementPositionsBeforeUpdate:i,flippedElementPositionsAfterUpdate:U,inProgressAnimations:a,decisionData:A},Be=function(R){var b,J=R.unflippedIds,M=R.flipCallbacks,te=R.getElement,Ae=R.flippedElementPositionsBeforeUpdate,xe=R.flippedElementPositionsAfterUpdate,rt=R.inProgressAnimations,_e=R.decisionData,G=J.filter(function(_){return xe[_]}).filter(function(_){return M[_]&&M[_].onAppear}),Ct=J.filter(function(_){return Ae[_]&&M[_]&&M[_].onExit}),ln=new Promise(function(_){b=_}),St=[],Ut=0,Ce=Ct.map(function(_,Xe){var Fe=Ae[_].domDataForExitAnimations,pe=Fe.element,Ve=Fe.parent,ot=Fe.childPosition,He=ot.top,un=ot.left,at=ot.width,it=ot.height;getComputedStyle(Ve).position==="static"&&(Ve.style.position="relative"),pe.style.transform="matrix(1, 0, 0, 1, 0, 0)",pe.style.position="absolute",pe.style.top=He+"px",pe.style.left=un+"px",pe.style.height=it+"px",pe.style.width=at+"px";var st=St.filter(function(Xt){return Xt[0]===Ve})[0];st||(st=[Ve,document.createDocumentFragment()],St.push(st)),st[1].appendChild(pe),Ut+=1;var Rt=function(){try{Ve.removeChild(pe)}catch{}finally{(Ut-=1)==0&&b()}};return rt[_]={stop:Rt},function(){return M[_].onExit(pe,Xe,Rt,_e)}});return St.forEach(function(_){_[0].appendChild(_[1])}),Ce.length||b(),{hideEnteringElements:function(){G.forEach(function(_){var Xe=te(_);Xe&&(Xe.style.opacity="0")})},animateEnteringElements:function(){G.forEach(function(_,Xe){var Fe=te(_);Fe&&M[_].onAppear(Fe,Xe,_e)})},animateExitingElements:function(){return Ce.forEach(function(_){return _()}),ln}}}(et({},De,{unflippedIds:he})),tt=Be.hideEnteringElements,nt=Be.animateEnteringElements,At=Be.animateExitingElements,Pe=et({},De,{containerEl:c,flippedIds:n.filter(me),applyTransformOrigin:p,spring:u,debug:d,staggerConfig:g,scopedSelector:fe,onComplete:V});D&&D(c,A);var cn=function(R){var b,J=R.flippedIds,M=R.flipCallbacks,te=R.inProgressAnimations,Ae=R.flippedElementPositionsBeforeUpdate,xe=R.flippedElementPositionsAfterUpdate,rt=R.applyTransformOrigin,_e=R.spring,G=R.getElement,Ct=R.debug,ln=R.staggerConfig,St=ln===void 0?{}:ln,Ut=R.decisionData,Ce=Ut===void 0?{}:Ut,_=R.onComplete,Xe=R.containerEl,Fe=new Promise(function(v){b=v});if(_&&Fe.then(function(){return _(Xe,Ce)}),!J.length)return function(){return b([]),Fe};var pe=[],Ve=G(J[0]),ot=Ve?Ve.ownerDocument.querySelector("body"):document.querySelector("body");Es(J);var He=J.map(function(v){var O=Ae[v].rect,z=xe[v].rect,Vt=Ae[v].opacity,ko=xe[v].opacity,No=z.width<1||z.height<1,se=xe[v].element;if(!Ms(O)&&!Ms(z)||!se)return!1;var Oo,Bo,Ho,$e=Is(se),$o=(Ho=(Bo=(Oo={flipperSpring:_e,flippedSpring:$e.spring})===void 0?{}:Oo).flippedSpring,et({},fo.noWobble,As(Bo.flipperSpring),As(Ho))),Uo=$e.stagger===!0?"default":$e.stagger,fc={element:se,id:v,stagger:Uo,springConfig:$o};if(M[v]&&M[v].shouldFlip&&!M[v].shouldFlip(Ce.previous,Ce.current))return!1;var mc=Math.abs(O.left-z.left)+Math.abs(O.top-z.top),hc=Math.abs(O.width-z.width)+Math.abs(O.height-z.height),gc=Math.abs(ko-Vt);if(O.height===0&&z.height===0||O.width===0&&z.width===0||mc<.5&&hc<.5&&gc<.01)return!1;var Xo=gs(xe[v].transform),ct={matrix:Xo},je={matrix:[]},jt=[Xo];$e.translate&&(jt.push(bs(O.left-z.left)),jt.push(Ps(O.top-z.top))),$e.scale&&(jt.push(vs(Math.max(O.width,1)/Math.max(z.width,1))),jt.push(ys(Math.max(O.height,1)/Math.max(z.height,1)))),$e.opacity&&(je.opacity=Vt,ct.opacity=ko);var pn=[];if(!M[v]||!M[v].shouldInvert||M[v].shouldInvert(Ce.previous,Ce.current)){var vc=function(ne,le){return Ht(ne.querySelectorAll("["+go+'="'+le+'"]'))}(se,v);pn=vc.map(function(ne){return[ne,Is(ne)]})}je.matrix=Rs(jt.reduce(hs)),ct.matrix=Rs(ct.matrix);var Gn,Vo=function(ne){var le=ne.element,lt=ne.invertedChildren,Jt=ne.body;return function(Mt){var ut=Mt.matrix,dn=Mt.opacity,Qn=Mt.forceMinVals;if(Xn(dn)&&(le.style.opacity=dn+""),Qn&&(le.style.minHeight="1px",le.style.minWidth="1px"),ut){var bc=function(Kt){return"matrix("+Kt.join(", ")+")"}(ut);le.style.transform=bc,lt&&function(Kt){var fn=Kt.matrix,Pc=Kt.body;Kt.invertedChildren.forEach(function(Ko){var qo=Ko[0],Yo=Ko[1];if(Pc.contains(qo)){var Go=fn[0],Qo=fn[3],Ac=fn[5],Je={translateX:0,translateY:0,scaleX:1,scaleY:1},Zn="";Yo.translate&&(Je.translateX=-fn[4]/Go,Je.translateY=-Ac/Qo,Zn+="translate("+Je.translateX+"px, "+Je.translateY+"px)"),Yo.scale&&(Je.scaleX=1/Go,Je.scaleY=1/Qo,Zn+=" scale("+Je.scaleX+", "+Je.scaleY+")"),qo.style.transform=Zn}})}({invertedChildren:lt,matrix:ut,body:Jt})}}}({element:se,invertedChildren:pn,body:ot});if(M[v]&&M[v].onComplete){var yc=M[v].onComplete;Gn=function(){return yc(se,Ce)}}var jo=Xn(je.opacity)&&Xn(ct.opacity)&&je.opacity!==ct.opacity,Jo=!1;return et({},fc,{stagger:Uo,springConfig:$o,getOnUpdateFunc:function(ne){var le=ne.spring,lt=ne.onAnimationEnd;return te[v]={destroy:le.destroy.bind(le),onAnimationEnd:lt},function(Jt){M[v]&&M[v].onSpringUpdate&&M[v].onSpringUpdate(Jt.getCurrentValue()),Jo||(Jo=!0,M[v]&&M[v].onStart&&M[v].onStart(se,Ce));var Mt=Jt.getCurrentValue();if(ot.contains(se)){var ut={matrix:[]};ut.matrix=je.matrix.map(function(dn,Qn){return po(dn,ct.matrix[Qn],Mt)}),jo&&(ut.opacity=po(je.opacity,ct.opacity,Mt)),Vo(ut)}else Jt.destroy()}},initializeFlip:function(){Vo({matrix:je.matrix,opacity:jo?je.opacity:void 0,forceMinVals:No}),M[v]&&M[v].onStartImmediate&&M[v].onStartImmediate(se,Ce),$e.transformOrigin?se.style.transformOrigin=$e.transformOrigin:rt&&(se.style.transformOrigin="0 0"),pn.forEach(function(ne){var le=ne[0],lt=ne[1];lt.transformOrigin?le.style.transformOrigin=lt.transformOrigin:rt&&(le.style.transformOrigin="0 0")})},onAnimationEnd:function(ne){delete te[v],Ts(Gn)&&Gn(),se.style.transform="",pn.forEach(function(le){le[0].style.transform=""}),No&&se&&(se.style.minHeight="",se.style.minWidth=""),ne||(pe.push(v),pe.length>=He.length&&b(pe))},delayUntil:$e.delayUntil})}).filter(Boolean);if(He.forEach(function(v){return(0,v.initializeFlip)()}),Ct)return function(){};var un=He.filter(function(v){return v.delayUntil&&(O=v.delayUntil,He.filter(function(z){return z.id===O}).length);var O}),at={},it={},st={};un.forEach(function(v){v.stagger?(st[v.stagger]=!0,it[v.delayUntil]?it[v.delayUntil].push(v.stagger):it[v.delayUntil]=[v.stagger]):at[v.delayUntil]?at[v.delayUntil].push(v):at[v.delayUntil]=[v]});var Rt=He.filter(function(v){return v.stagger}).reduce(function(v,O){return v[O.stagger]?v[O.stagger].push(O):v[O.stagger]=[O],v},{}),Xt=He.filter(function(v){return un.indexOf(v)===-1});return Xt.forEach(function(v){v.onSpringActivate=function(){at[v.id]&&at[v.id].forEach(Cs),it[v.id]&&Object.keys(it[v.id].reduce(function(O,z){var Vt;return et(O,((Vt={})[z]=!0,Vt))},{})).forEach(function(O){Ss(Rt[O],St[O])})}}),function(){return He.length||b([]),Xt.filter(function(v){return!v.stagger}).forEach(Cs),Object.keys(Rt).forEach(function(v){st[v]||Ss(Rt[v],St[v])}),Fe}}(Pe);E?E({hideEnteringElements:tt,animateEnteringElements:nt,animateExitingElements:At,animateFlippedElements:cn}):(tt(),At().then(nt),cn())}},Bs=function(e){var t=e.element,n=e.flipCallbacks,r=n===void 0?{}:n,a=e.inProgressAnimations,o=a===void 0?{}:a,i=ks(t,e.portalKey),s=Ht(t.querySelectorAll("["+go+"]")),l={},c=[],p={};i.filter(function(m){return r&&r[m.dataset.flipId]&&r[m.dataset.flipId].onExit}).forEach(function(m){var f=m.parentNode;if(m.closest){var g=m.closest("["+ws+"]");g&&(f=g)}var y=c.findIndex(function(A){return A[0]===f});y===-1&&(c.push([f,f.getBoundingClientRect()]),y=c.length-1),l[m.dataset.flipId]=c[y][1],p[m.dataset.flipId]=f});var u=Ns(i),d=u.map(function(m){var f=m[0],g=m[1],y={};if(r&&r[f.dataset.flipId]&&r[f.dataset.flipId].onExit){var A=l[f.dataset.flipId];et(y,{element:f,parent:p[f.dataset.flipId],childPosition:{top:g.top-A.top,left:g.left-A.left,width:g.width,height:g.height}})}return[f.dataset.flipId,{rect:g,opacity:parseFloat(window.getComputedStyle(f).opacity||"1"),domDataForExitAnimations:y}]}).reduce(Fs,{});return function(m,f){Object.keys(m).forEach(function(g){m[g].destroy&&m[g].destroy(),m[g].onAnimationEnd&&m[g].onAnimationEnd(!0),delete m[g]}),f.forEach(function(g){g.style.transform="",g.style.opacity=""})}(o,i.concat(s)),{flippedElementPositions:d,cachedOrderedFlipIds:u.map(function(m){return m[0].dataset.flipId})}};var af=new xs;var W=h(w());function Vn(){return Vn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Vn.apply(this,arguments)}function yo(e,t){return yo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},yo(e,t)}function $s(e,t){if(e==null)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t.indexOf(n=o[r])>=0||(a[n]=e[n]);return a}var Us=(0,W.createContext)({}),Xs=(0,W.createContext)("portal"),bo=function(e){var t,n;function r(){for(var o,i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return(o=e.call.apply(e,[this].concat(s))||this).inProgressAnimations={},o.flipCallbacks={},o.el=void 0,o}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,yo(t,n);var a=r.prototype;return a.getSnapshotBeforeUpdate=function(o){return o.flipKey!==this.props.flipKey&&this.el?Bs({element:this.el,flipCallbacks:this.flipCallbacks,inProgressAnimations:this.inProgressAnimations,portalKey:this.props.portalKey}):null},a.componentDidUpdate=function(o,i,s){this.props.flipKey!==o.flipKey&&this.el&&Os({flippedElementPositionsBeforeUpdate:s.flippedElementPositions,cachedOrderedFlipIds:s.cachedOrderedFlipIds,containerEl:this.el,inProgressAnimations:this.inProgressAnimations,flipCallbacks:this.flipCallbacks,applyTransformOrigin:this.props.applyTransformOrigin,spring:this.props.spring,debug:this.props.debug,portalKey:this.props.portalKey,staggerConfig:this.props.staggerConfig,handleEnterUpdateDelete:this.props.handleEnterUpdateDelete,decisionData:{previous:o.decisionData,current:this.props.decisionData},onComplete:this.props.onComplete,onStart:this.props.onStart})},a.render=function(){var o=this,i=this.props,s=i.portalKey,l=W.default.createElement(Us.Provider,{value:this.flipCallbacks},W.default.createElement(i.element,{className:i.className,ref:function(c){return o.el=c}},this.props.children));return s&&(l=W.default.createElement(Xs.Provider,{value:s},l)),l},r}(W.Component);bo.defaultProps={applyTransformOrigin:!0,element:"div"};var Ku=["children","flipId","inverseFlipId","portalKey"],qu=["children","flipId","shouldFlip","shouldInvert","onAppear","onStart","onStartImmediate","onComplete","onExit","onSpringUpdate"],Hs=function(e){var t,n=e.children,r=e.flipId,a=e.inverseFlipId,o=e.portalKey,i=$s(e,Ku),s=n,l=function(p){return typeof p=="function"}(s);if(!l)try{s=W.Children.only(n)}catch{throw new Error("Each Flipped component must wrap a single child")}i.scale||i.translate||i.opacity||mo.assign(i,{translate:!0,scale:!0,opacity:!0});var c=((t={})[rn.DATA_FLIP_CONFIG]=JSON.stringify(i),t);return r!==void 0?c[rn.DATA_FLIP_ID]=String(r):a&&(c[rn.DATA_INVERSE_FLIP_ID]=String(a)),o!==void 0&&(c[rn.DATA_PORTAL_KEY]=o),l?s(c):(0,W.cloneElement)(s,c)},Po=function(e){var t=e.children,n=e.flipId,r=e.shouldFlip,a=e.shouldInvert,o=e.onAppear,i=e.onStart,s=e.onStartImmediate,l=e.onComplete,c=e.onExit,p=e.onSpringUpdate,u=$s(e,qu);return t?u.inverseFlipId?W.default.createElement(Hs,Vn({},u),t):W.default.createElement(Xs.Consumer,null,function(d){return W.default.createElement(Us.Consumer,null,function(m){return mo.isObject(m)&&n&&(m[n]={shouldFlip:r,shouldInvert:a,onAppear:o,onStart:i,onStartImmediate:s,onComplete:l,onExit:c,onSpringUpdate:p}),W.default.createElement(Hs,Vn({flipId:n},u,{portalKey:d}),t)})}):null};Po.displayName="Flipped";var wo=h(qs());function np(e){let t=Math.ceil(Math.sqrt(e)),n=[{rows:t,cols:t}];for(let r=1;r<t;r++)n.push({rows:r,cols:Math.ceil(e/r)});for(let r=1;r<t;r++)n.push({cols:r,rows:Math.ceil(e/r)});return n}function Ys(e){let{count:t,height:n,width:r}=e;if(n===0||r===0)return{cols:0,rows:0};let a=null,o=0,i=4/3;for(let s of np(t)){let l=n/s.rows,c=r/s.cols,u=(l>c?"width":"height")==="height"?i*l*l:1/i*c*c;u>o&&(o=u,a=s)}return oe(a),a}var Pt=h(w());var vt=h(w());function Mo(e,t,n,r,a){let[o,i]=(0,vt.useState)(!1),{partyTracks:s,traceLink:l,room:c,feedbackEnabled:p}=I(),u=re(s.peerConnection$),d=(0,vt.useRef)(-1);(0,vt.useEffect)(()=>{if(!(!u||!r||!n||o||!p))return d.current=window.setTimeout(()=>{u.getStats(r).then(m=>{if(d.current===-1)return;[...m.values()].find(g=>g.trackIdentifier===r.id)?.bytesReceived===0&&i(!0)})},1e4),()=>{clearTimeout(d.current),d.current=-1}},[o,n,p,s,u,r]),(0,vt.useEffect)(()=>{if(!t||!o||!p)return;let m=Ne(t,l),[f,g]=e?.split("/")??[],y=Ne(f,l);if(y&&m){let A={pullSessionTrace:m,pushedSessionTrace:y,trackId:g,pullingUser:c.identity?.name,pushingUser:a};fetch("/api/deadTrack",{method:"POST",body:JSON.stringify(A)})}},[o,u,p,a,t,c.identity?.name,l,e])}var be=h(w()),rp=(e,t)=>{let n=new Map(t.map(o=>[o.id,o])),r=new Map(e.map(o=>[o.id,o])),a=t.filter(({id:o})=>!r.has(o));return e.reduce((o,i)=>{let s=n.get(i.id);if(s===void 0){let l=a[0];if(!l)return o;o.push(l),a.splice(0,1)}else o.push(s);return o},[]).concat(a)},yt="_screenshare";function Io(e,t,n){let r=(0,be.useMemo)(()=>e.concat(n?[n]:[]).flatMap(u=>u.tracks.screenshare?[u,{...u,id:u.id+yt,tracks:{...u.tracks,video:u.tracks.screenshare,videoEnabled:u.tracks.screenShareEnabled}}]:[u]),[n,e]),[a,o]=(0,be.useState)(r.slice(0,t)),[i,s]=(0,be.useState)({}),l=(0,be.useCallback)(u=>{s(d=>({...d,[u.id]:Date.now()}))},[]),c=(0,be.useMemo)(()=>[...r].sort((u,d)=>u.id===n?.id?-1:d.id===n?.id?1:u.id.includes(yt)&&!d.id.includes(yt)?-1:!u.id.includes(yt)&&d.id.includes(yt)?1:(i[d.id]??0)-(i[u.id]??0)).slice(0,t),[i,t,n?.id,r]),p=(0,be.useMemo)(()=>r.filter(u=>i[u.id]===void 0),[i,r]);return(0,be.useEffect)(()=>{p.forEach(l)},[p,l]),(0,be.useEffect)(()=>{o(u=>rp(u,c))},[c,t]),{actorsOnStage:a,recordActivity:l}}function bt(e){return e!=null}var Gs=(e,t=0)=>n=>new Pn(r=>{let a=new Ge(e,t);n.subscribe({...r,next:o=>{a.insert(o),r.next(a.value())}})});function op(e,t=3e3){return dt([e,An(t)]).pipe(ke(([n])=>n.getStats()),Cn())}function Qs(e,t){return dt([t,e,op(e)]).pipe(It(([n,r,[a,o]])=>{let i=r.getTransceivers().reduce((g,y)=>{let A=y.sender.track??y.receiver.track;return A!==null&&y.mid!==null&&g.set(A,y.mid),g},new Map),s=new Set;for(let g of n){let y=i.get(g);y&&s.add(y)}let l=0,c=0,p=0,u=0;o.forEach(g=>{if(!s.has(g.mid))return;let y=a.get(g.id);if(y){if(g.type==="inbound-rtp")c+=g.packetsLost-y.packetsLost,l+=g.packetsReceived-y.packetsReceived;else if(g.type==="outbound-rtp"){let A=g.packetsSent-y.packetsSent,E=Array.from(o.values()).find(D=>D.type==="remote-inbound-rtp"&&D.ssrc===g.ssrc),V=Array.from(a.values()).find(D=>D.type==="remote-inbound-rtp"&&D.ssrc===y.ssrc);E&&V&&A>0&&(p+=g.packetsSent-y.packetsSent,u+=E.packetsLost-V.packetsLost)}}});let d=c+u,m=l+p+d,f=0;return m>0&&(f=Math.max(0,d/m)),f}))}var To=h(w());function Zs(e){let{partyTracks:t}=I(),[n,r]=e?.split("/")??[],a=(0,To.useMemo)(()=>n&&r?{trackName:r,sessionId:n,location:"remote"}:void 0,[n,r]),o=Sn(a),i=(0,To.useMemo)(()=>o.pipe(ke(s=>s?t.pull(pt(s)):pt(void 0))),[t,o]);return re(i)}var zs=h(C()),Lo=({audioTrack:e,children:t,className:n,type:r})=>{let a=ra(e);return(0,zs.jsx)("span",{className:F(r==="text"?"orange-glow-text":"orange-glow-box","opacity-[--opacity] transition-opacity",n),style:{"--opacity":Math.min(1,a*4)},"aria-hidden":!0,children:t})};var Ws=h(w());var jn=h(C());function ec(e){return e>.05?"bad":e>.03?"unhealthy":e>.01?"tolerable":"healthy"}function tc(e){let[t,n]=(0,Ws.useState)(!1);return(0,jn.jsx)(Q,{open:t,onOpenChange:n,content:`Connection is ${e.quality}`,children:(0,jn.jsx)("button",{onClick:()=>n(!t),children:(0,jn.jsx)(x,{className:F(e.quality==="healthy"&&"text-green-400",e.quality==="tolerable"&&"text-green-400",e.quality==="unhealthy"&&"text-yellow-400",e.quality==="bad"&&"text-red-400"),type:e.quality==="bad"||e.quality==="unhealthy"?"SignalSlashIcon":"SignalIcon"})})})}var on=h(w());var rc=h(C()),nc=({timeout:e=2e3,children:t,className:n})=>{let[r,a]=(0,on.useState)(0),[o,i]=(0,on.useState)(!1);return(0,on.useEffect)(()=>{let s=!0;if(o){let l=setTimeout(()=>{s&&i(!1)},e);return()=>{clearTimeout(l)}}},[e,o,r]),(0,rc.jsx)("div",{className:F("hover-fade",!o&&"inactive",n),onPointerLeave:()=>{i(!1)},onPointerMove:()=>{i(!0),a(Date.now())},children:t})};var T=h(C());function oc(e){let{partyTracks:t}=I(),n=(0,Pt.useMemo)(()=>dt([t.peerConnection$,t.peerConnection$.pipe(ke(a=>na(a,"track")))]).pipe(It(([a])=>a.getTransceivers())),[t.peerConnection$]),r=re(n,[]);return e?r.find(a=>a.sender.track===e||a.receiver.track===e)?.mid:null}var Eo=(0,Pt.forwardRef)(({user:e},t)=>{let{data:n}=Ye(e.name),{traceLink:r,partyTracks:a,dataSaverMode:o,pinnedTileIds:i,setPinnedTileIds:s,showDebugInfo:l,userMedia:c,room:{identity:p}}=I(),u=re(a.peerConnection$),d=e.id,m=p&&d.startsWith(p.id),f=d.endsWith(yt),g=e.id==="ai",y=mt(g?e.tracks.audio:void 0),A=Lt(e.id==="ai"?y:void 0)||e.speaking,E=mt(f?void 0:e.tracks.audio),V=Zs(f||!m&&!o?e.tracks.video:void 0),D=m?c.audioStreamTrack:E,ee=m&&!f?c.videoStreamTrack:V;Mo(e.tracks.video,e.transceiverSessionId,!!e.tracks.video,ee,e.name),Mo(e.tracks.audio,e.transceiverSessionId,!!e.tracks.audio,D,e.name);let U=i.includes(d);(0,Pt.useEffect)(()=>{f&&s(De=>[...De,d])},[d,f,s]);let fe=(0,Pt.useMemo)(()=>Qs(a.peerConnection$,pt([D,ee].filter(bt))).pipe(Gs(5e3)),[D,a.peerConnection$,ee]),j=re(fe,0),me=oc(D),he=oc(ee);return(0,T.jsx)("div",{className:"grow shrink text-base basis-[calc(var(--flex-container-width)_-_var(--gap)_*_3)]",ref:t,children:(0,T.jsx)(Po,{flipId:d+U,children:(0,T.jsxs)("div",{className:F("h-full mx-auto overflow-hidden text-white opacity-0 animate-fadeIn","relative max-w-[--participant-max-width] rounded-xl"),children:[!f&&(0,T.jsx)("div",{className:F("absolute inset-0 h-full w-full grid place-items-center"),children:(0,T.jsx)("div",{className:"h-[2em] w-[2em] grid place-items-center text-4xl md:text-6xl 2xl:text-8xl relative",children:n?.photob64?(0,T.jsxs)("div",{children:[(0,T.jsx)(Lo,{className:"absolute inset-0 w-full h-full rounded-full",audioTrack:D,type:"box"}),(0,T.jsx)("img",{className:"rounded-full",src:`data:image/png;base64,${n.photob64}`,alt:n.displayName})]}):(0,T.jsxs)("span",{className:"relative grid w-full h-full uppercase rounded-full place-items-center bg-zinc-500",children:[A&&(0,T.jsx)(Lo,{type:"text",className:"absolute uppercase",audioTrack:D,children:e.name.charAt(0)}),e.name.charAt(0)]})})}),(0,T.jsx)(fa,{className:F("absolute inset-0 h-full w-full object-contain opacity-0 transition-opacity",m&&!f&&"-scale-x-100",{"opacity-100":f?e.tracks.screenShareEnabled:e.tracks.videoEnabled&&(!o||m)},m&&f&&"opacity-75"),videoTrack:ee}),!f&&(0,T.jsx)(nc,{className:"absolute inset-0 grid w-full h-full place-items-center",children:(0,T.jsx)("div",{className:"flex gap-2 p-2 rounded bg-zinc-900/30",children:!f&&(0,T.jsx)(Bn,{displayType:"ghost",mutedDisplayType:"ghost",user:e})})}),D&&!f&&(0,T.jsxs)("div",{className:"absolute left-4 top-4",children:[e.tracks.audioEnabled&&e.tracks.videoEnabled&&A&&(0,T.jsx)(Rn,{audioTrack:D}),!e.tracks.audioEnabled&&!e.tracks.audioUnavailable&&(0,T.jsx)(Q,{content:"Mic is turned off",children:(0,T.jsxs)("div",{className:"indication-shadow",children:[(0,T.jsx)(x,{type:"micOff"}),(0,T.jsx)(ue,{children:"Mic is muted"})]})}),e.tracks.audioUnavailable&&(0,T.jsx)(Q,{content:"Mic is unavailable. User cannot unmute.",children:(0,T.jsxs)("div",{className:"indication-shadow",children:[(0,T.jsx)(x,{type:"micOff",className:"text-red-400"}),(0,T.jsx)(ue,{children:"Mic is muted"})]})})]}),n?.displayName&&e.transceiverSessionId&&(0,T.jsxs)("div",{className:"flex items-center gap-2 absolute m-2 text-shadow left-1 bottom-1",children:[(0,T.jsx)(tc,{quality:ec(j)}),(0,T.jsxs)(Ot,{className:"leading-none",href:Ne(e.transceiverSessionId,r),target:"_blank",rel:"noopener noreferrer",children:[n.displayName,l&&u&&(0,T.jsxs)("span",{className:"opacity-50",children:[" ",[me&&`audio mid: ${me}`,he&&`video mid: ${he}`].filter(Boolean).join(" ")]})]})]}),(0,T.jsx)("div",{className:"absolute top-0 right-0 flex gap-4 p-4",children:e.raisedHand&&!f&&(0,T.jsx)(Q,{content:"Hand is raised",children:(0,T.jsx)("div",{className:"relative",children:(0,T.jsxs)("div",{className:"relative",children:[(0,T.jsx)(x,{className:"indication-shadow",type:"handRaised"}),(0,T.jsx)(x,{className:"absolute top-0 left-0 text-orange-300 animate-ping",type:"handRaised"}),(0,T.jsx)(ue,{children:"Hand is raised"})]})})})}),(A||e.raisedHand)&&!f&&(0,T.jsx)("div",{className:F("pointer-events-none absolute inset-0 h-full w-full border-4 border-orange-400",!U&&"rounded-xl")})]})})})});Eo.displayName="Participant";var Jn=h(C());function Do(e){let[t,{width:n,height:r}]=(0,wo.default)(),[a,{width:o}]=(0,wo.default)(),i=(0,Kn.useMemo)(()=>100/Ys({count:e.users.length,height:r,width:n}).cols+"%",[r,n,e.users.length]),s=(0,Kn.useId)();return e.users.length===0?null:(0,Jn.jsx)(bo,{flipKey:s+e.users.length,children:(0,Jn.jsx)("div",{className:"absolute inset-0 h-full w-full isolate flex flex-wrap justify-around gap-[--gap]",style:{"--flex-container-width":i,"--participant-max-width":o+"px"},ref:t,children:e.users.map((l,c)=>(0,Jn.jsx)(Eo,{user:l,ref:c===0?a:void 0},l.id))})})}var qn=h(C()),ac=({raisedHand:e,onClick:t})=>(0,qn.jsx)(Q,{content:e?"Lower hand":"Raise Hand",children:(0,qn.jsx)(k,{displayType:e?"primary":"secondary",onClick:n=>{t&&t(),e||Ie("raiseHand")},children:(0,qn.jsx)(x,{type:"handRaised"})})});var Yn=h(w());var $t=h(C()),ic=()=>{let{userMedia:{screenShareVideoTrack:e,startScreenShare:t,endScreenShare:n},room:{otherUsers:r}}=I(),a=r.some(l=>l.tracks.screenshare),o=e!==void 0,[i,s]=(0,Yn.useState)(!0);return(0,Yn.useEffect)(()=>{s(typeof navigator.mediaDevices<"u"&&navigator.mediaDevices.getDisplayMedia!==void 0)},[]),i?(0,$t.jsx)(Q,{content:a?"Someone else is sharing":o?"Stop sharing":"Share screen",children:(0,$t.jsxs)(k,{displayType:o?"danger":"secondary",disabled:a,onClick:o?n:t,children:[(0,$t.jsx)(ue,{children:"Share screen"}),(0,$t.jsx)(x,{type:"screenshare"})]})}):null};var sc=h(w());function xo({userMedia:e,identity:t,websocket:n,partyTracks:r,pushedTracks:a,raisedHand:o,speaking:i}){let{audioEnabled:s,videoEnabled:l,screenShareEnabled:c,audioUnavailableReason:p}=e,{audio:u,video:d,screenshare:m}=a,{sessionId:f}=re(r.session$)??{},g=p!==void 0,y=t?.id,A=t?.name;(0,sc.useEffect)(()=>{if(y&&A){let D=function(){n.send(JSON.stringify({type:"userUpdate",user:V}))};var E=D;let V={id:y,name:A,joined:!0,raisedHand:o,speaking:i,transceiverSessionId:f,tracks:{audioEnabled:s,audioUnavailable:g,videoEnabled:l,screenShareEnabled:c,video:d,audio:u,screenshare:m}};return D(),n.addEventListener("open",D),()=>n.removeEventListener("open",D)}},[y,A,n,f,u,d,m,s,l,c,o,i,p,g]),yn(()=>{y&&A&&n.send(JSON.stringify({type:"userUpdate",user:{id:y,name:A,joined:!1,raisedHand:o,speaking:i,transceiverSessionId:f,tracks:{audioUnavailable:g}}}))})}var cc=h(w());function lc(){let{showDebugInfo:e,setShowDebugInfo:t}=I();(0,cc.useEffect)(()=>{let n=r=>{r.key.toLowerCase()==="d"&&r.ctrlKey&&(r.preventDefault(),t(!e))};return document.addEventListener("keypress",n),()=>{document.removeEventListener("keypress",n)}},[t,e])}var _o=h(w());function Fo(e){let t=tr(e.length);(0,_o.useEffect)(()=>{e.length>5||t===void 0||t===e.length||(e.length>t?Ie("join"):Ie("leave"))},[t,e.length]);let n=e.filter(a=>a.raisedHand).length,r=tr(n);(0,_o.useEffect)(()=>{r===void 0||n===r||n>r&&Ie("raiseHand")},[n,r]),vn(()=>{Ie("join")}),yn(()=>{Ie("leave")})}var an=h(w());var Oe=h(C());function uc(e){let{traceLink:t}=I(),{data:n}=Ye(e.user.name);return(0,Oe.jsxs)("div",{className:"flex items-center justify-center gap-2 text-sm",children:[(0,Oe.jsxs)(Me.Title,{children:[(0,Oe.jsx)(Ot,{href:e.user.transceiverSessionId?Ne(e.user.transceiverSessionId,t):void 0,target:"_blank",rel:"noopener noreferrer",children:n?.displayName})," ",e.type]}),(0,Oe.jsxs)(Me.Close,{className:"flex items-center justify-center w-5 h-5 px-1 rounded hover:bg-zinc-200 dark:hover:bg-zinc-600",children:[(0,Oe.jsx)("span",{"aria-hidden":!0,children:"\xD7"}),(0,Oe.jsx)(ue,{children:"Dismiss"})]})]})}function pc(e){let[t,n]=(0,an.useState)(e),r=pa();(0,an.useEffect)(()=>{let a=e.filter(i=>!t.some(s=>s.id===i.id)),o=t.filter(i=>!e.some(s=>s.id===i.id));a.forEach(i=>r((0,Oe.jsx)(uc,{user:i,type:"joined"}))),o.forEach(i=>r((0,Oe.jsx)(uc,{user:i,type:"left"})))},[r,t,e]),(0,an.useEffect)(()=>{n(e)},[e])}var ip=h(Mc());var H=h(C());function dc(){let{joined:e}=I(),t=mn(),{roomName:n}=hn(),{mode:r,bugReportsEnabled:a}=er(),[o]=gn();return(0,sn.useEffect)(()=>{!e&&r!=="development"&&t(`/${n}${o.size>0?"?"+o.toString():""}`)},[e,r,t,n,o]),!e&&r!=="development"?null:(0,H.jsx)(Me.Provider,{children:(0,H.jsx)(sp,{bugReportsEnabled:a})})}function sp({bugReportsEnabled:e}){let{hasDb:t,hasAiCredentials:n}=er(),{userMedia:r,partyTracks:a,pushedTracks:o,showDebugInfo:i,pinnedTileIds:s,room:{otherUsers:l,websocket:c,identity:p,roomState:{meetingId:u}}}=I();lc();let[d,m]=(0,sn.useState)(!1),f=Lt(r.audioStreamTrack);vn(()=>{l.length>5&&r.turnMicOff()}),xo({userMedia:r,partyTracks:a,websocket:c,identity:p,pushedTracks:o,raisedHand:d,speaking:f}),Fo(l),pc(l);let{width:g}=zo(),y=l.some(U=>U.tracks.screenshare)||!!p?.tracks.screenshare,A=g<600?2:y?5:8,{recordActivity:E,actorsOnStage:V}=Io(l,A,p);(0,sn.useEffect)(()=>{l.forEach(U=>{(U.speaking||U.raisedHand)&&E(U)})},[l,E]);let D=V.filter(U=>s.includes(U.id)),ee=V.filter(U=>!s.includes(U.id));return(0,H.jsxs)(Va,{audioTracks:l.map(U=>U.tracks.audio).filter(bt),children:[(0,H.jsxs)("div",{className:"flex flex-col h-full bg-white dark:bg-zinc-800",children:[(0,H.jsxs)("div",{className:"relative flex-grow bg-black isolate",children:[(0,H.jsxs)("div",{className:"absolute inset-0 flex isolate gap-[var(--gap)] p-[var(--gap)]",style:{"--gap":"1rem"},children:[D.length>0&&(0,H.jsx)("div",{className:"flex-grow-[5] overflow-hidden relative",children:(0,H.jsx)(Do,{users:D.filter(bt)})}),(0,H.jsx)("div",{className:"flex-grow overflow-hidden relative",children:(0,H.jsx)(Do,{users:ee.filter(bt)})})]}),(0,H.jsx)(Me.Viewport,{className:"absolute bottom-0 right-0"})]}),(0,H.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-2 p-2 text-sm md:gap-4 md:p-5 md:text-base",children:[n&&(0,H.jsx)(Ka,{recordActivity:E}),(0,H.jsx)(da,{warnWhenSpeakingWhileMuted:!0}),(0,H.jsx)(la,{}),(0,H.jsx)(ic,{}),(0,H.jsx)(ac,{raisedHand:d,onClick:()=>m(!d)}),(0,H.jsx)(us,{identity:p,otherUsers:l,className:"hidden md:block"}),(0,H.jsx)(ms,{bugReportsEnabled:e}),(0,H.jsx)(Wa,{navigateToFeedbackPage:t,meetingId:u}),i&&u&&(0,H.jsx)(ua,{contentValue:u,children:"Meeting Id"})]})]}),(0,H.jsx)(Za,{}),(0,H.jsx)(za,{})]})}export{dc as default};
/*! Bundled license information:

rematrix/dist/rematrix.es.js:
  (*! @license Rematrix v0.2.2
  
  	Copyright 2018 Fisssion LLC.
  
  	Permission is hereby granted, free of charge, to any person obtaining a copy
  	of this software and associated documentation files (the "Software"), to deal
  	in the Software without restriction, including without limitation the rights
  	to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  	copies of the Software, and to permit persons to whom the Software is
  	furnished to do so, subject to the following conditions:
  
  	The above copyright notice and this permission notice shall be included in
  	all copies or substantial portions of the Software.
  
  	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  	IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  	FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  	AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  	LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  	OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  	THE SOFTWARE.
  *)
*/
