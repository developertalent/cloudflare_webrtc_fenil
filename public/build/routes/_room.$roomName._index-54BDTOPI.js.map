{
  "version": 3,
  "sources": ["../../../app/routes/_room.$roomName._index.tsx", "../../../app/components/SelfView.tsx"],
  "sourcesContent": ["// REMIX HMR BEGIN\nif (!window.$RefreshReg$ || !window.$RefreshSig$ || !window.$RefreshRuntime$) {\n  console.warn('remix:hmr: React Fast Refresh only works when the Remix compiler is running in development mode.');\n} else {\n  var prevRefreshReg = window.$RefreshReg$;\n  var prevRefreshSig = window.$RefreshSig$;\n  window.$RefreshReg$ = (type, id) => {\n    window.$RefreshRuntime$.register(type, \"\\\"app/routes/_room.$roomName._index.tsx\\\"\" + id);\n  }\n  window.$RefreshSig$ = window.$RefreshRuntime$.createSignatureFunctionForTransform;\n}\nvar _s = $RefreshSig$();\nimport * as __hmr__ from \"remix:hmr\";\nif (import.meta) {\n  import.meta.hot = __hmr__.createHotContext(\n  //@ts-expect-error\n  \"app/routes/_room.$roomName._index.tsx\");\n  import.meta.hot.lastModified = \"1738073419119.2837\";\n}\n// REMIX HMR END\n\nimport { VisuallyHidden } from '@radix-ui/react-visually-hidden';\nimport { json } from '@remix-run/cloudflare';\nimport { useNavigate, useParams, useSearchParams } from '@remix-run/react';\nimport { useObservableAsValue } from 'partytracks/react';\nimport invariant from 'tiny-invariant';\nimport { AudioIndicator } from '~/components/AudioIndicator';\nimport { Button } from '~/components/Button';\nimport { CameraButton } from '~/components/CameraButton';\nimport { CopyButton } from '~/components/CopyButton';\nimport { Disclaimer } from '~/components/Disclaimer';\nimport { Icon } from '~/components/Icon/Icon';\nimport { MicButton } from '~/components/MicButton';\nimport { SelfView } from '~/components/SelfView';\nimport { SettingsButton } from '~/components/SettingsDialog';\nimport { Spinner } from '~/components/Spinner';\nimport { Tooltip } from '~/components/Tooltip';\nimport { useRoomContext } from '~/hooks/useRoomContext';\nimport { useRoomUrl } from '~/hooks/useRoomUrl';\nimport getUsername from '~/utils/getUsername.server';\nexport const loader = async ({\n  request,\n  context\n}) => {\n  const username = await getUsername(request);\n  invariant(username);\n  return json({\n    username,\n    callsAppId: context.env.CALLS_APP_ID\n  });\n};\nlet refreshCheckDone = false;\nfunction trackRefreshes() {\n  if (refreshCheckDone) return;\n  if (typeof document === 'undefined') return;\n  const key = `previously loaded`;\n  const initialValue = sessionStorage.getItem(key);\n  const refreshed = initialValue !== null;\n  sessionStorage.setItem(key, Date.now().toString());\n  if (refreshed) {\n    fetch(`/api/reportRefresh`, {\n      method: 'POST'\n    });\n  }\n  refreshCheckDone = true;\n}\nexport default function Lobby() {\n  _s();\n  const {\n    roomName\n  } = useParams();\n  const navigate = useNavigate();\n  const {\n    setJoined,\n    userMedia,\n    room,\n    partyTracks\n  } = useRoomContext();\n  const {\n    videoStreamTrack,\n    audioStreamTrack,\n    audioEnabled\n  } = userMedia;\n  const session = useObservableAsValue(partyTracks.session$);\n  const sessionError = useObservableAsValue(partyTracks.sessionError$);\n  trackRefreshes();\n  const joinedUsers = new Set(room.otherUsers.filter(u => u.tracks.audio).map(u => u.name)).size;\n  const roomUrl = useRoomUrl();\n  const [params] = useSearchParams();\n  return <div className=\"flex flex-col items-center justify-center h-full p-4\">\n\t\t\t<div className=\"flex-1\"></div>\n\t\t\t<div className=\"space-y-4 w-96\">\n\t\t\t\t<div>\n\t\t\t\t\t<h1 className=\"text-3xl font-bold\">{roomName}</h1>\n\t\t\t\t\t<p className=\"text-sm text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t\t\t{`${joinedUsers} ${joinedUsers === 1 ? 'user' : 'users'} in the room.`}{' '}\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"relative\">\n\t\t\t\t\t<SelfView className=\"aspect-[4/3] w-full\" videoTrack={videoStreamTrack} />\n\n\t\t\t\t\t<div className=\"absolute left-3 top-3\">\n\t\t\t\t\t\t{!sessionError && !session?.sessionId ? <Spinner className=\"text-zinc-100\" /> : audioStreamTrack && <>\n\t\t\t\t\t\t\t\t\t{audioEnabled ? <AudioIndicator audioTrack={audioStreamTrack} /> : <Tooltip content=\"Mic is turned off\">\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-white indication-shadow\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Icon type=\"micOff\" />\n\t\t\t\t\t\t\t\t\t\t\t\t<VisuallyHidden>Mic is turned off</VisuallyHidden>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</Tooltip>}\n\t\t\t\t\t\t\t\t</>}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{sessionError && <div className=\"p-3 rounded-md text-sm text-zinc-800 bg-red-200 dark:text-zinc-200 dark:bg-red-700\">\n\t\t\t\t\t\t{sessionError}\n\t\t\t\t\t</div>}\n\t\t\t\t{(userMedia.audioUnavailableReason || userMedia.videoUnavailableReason) && <div className=\"p-3 rounded-md text-sm text-zinc-800 bg-zinc-200 dark:text-zinc-200 dark:bg-zinc-700\">\n\t\t\t\t\t\t{userMedia.audioUnavailableReason === 'NotAllowedError' && userMedia.videoUnavailableReason === undefined && <p>Mic permission was denied.</p>}\n\t\t\t\t\t\t{userMedia.videoUnavailableReason === 'NotAllowedError' && userMedia.audioUnavailableReason === undefined && <p>Camera permission was denied.</p>}\n\t\t\t\t\t\t{userMedia.audioUnavailableReason === 'NotAllowedError' && userMedia.videoUnavailableReason === 'NotAllowedError' && <p>Mic and camera permissions were denied.</p>}\n\t\t\t\t\t\t{userMedia.audioUnavailableReason === 'NotAllowedError' && <p>\n\t\t\t\t\t\t\t\tEnable permission\n\t\t\t\t\t\t\t\t{userMedia.audioUnavailableReason && userMedia.videoUnavailableReason ? 's' : ''}{' '}\n\t\t\t\t\t\t\t\tand reload the page to join.\n\t\t\t\t\t\t\t</p>}\n\t\t\t\t\t\t{userMedia.audioUnavailableReason === 'DevicesExhaustedError' && <p>No working microphone found.</p>}\n\t\t\t\t\t\t{userMedia.videoUnavailableReason === 'DevicesExhaustedError' && <p>No working webcam found.</p>}\n\t\t\t\t\t\t{userMedia.audioUnavailableReason === 'UnknownError' && <p>Unknown microphone error.</p>}\n\t\t\t\t\t\t{userMedia.videoUnavailableReason === 'UnknownError' && <p>Unknown webcam error.</p>}\n\t\t\t\t\t</div>}\n\t\t\t\t<div className=\"flex gap-4 text-sm\">\n\t\t\t\t\t<Button onClick={() => {\n          setJoined(true);\n          // we navigate here with javascript instead of an a\n          // tag because we don't want it to be possible to join\n          // the room without the JS having loaded\n          navigate('room' + (params.size > 0 ? '?' + params.toString() : ''));\n        }} disabled={!session?.sessionId}>\n\t\t\t\t\t\tJoin\n\t\t\t\t\t</Button>\n\t\t\t\t\t<MicButton />\n\t\t\t\t\t<CameraButton />\n\t\t\t\t\t<SettingsButton />\n\t\t\t\t\t<Tooltip content=\"Copy URL\">\n\t\t\t\t\t\t<CopyButton contentValue={roomUrl}></CopyButton>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"flex flex-col justify-end flex-1\">\n\t\t\t\t<Disclaimer className=\"pt-6\" />\n\t\t\t</div>\n\t\t</div>;\n}\n_s(Lobby, \"6hdlJegDogLMft/figb6jpqhFAM=\", false, function () {\n  return [useParams, useNavigate, useRoomContext, useObservableAsValue, useObservableAsValue, useRoomUrl, useSearchParams];\n});\n_c = Lobby;\nvar _c;\n$RefreshReg$(_c, \"Lobby\");\n\nwindow.$RefreshReg$ = prevRefreshReg;\nwindow.$RefreshSig$ = prevRefreshSig;", "// REMIX HMR BEGIN\nif (!window.$RefreshReg$ || !window.$RefreshSig$ || !window.$RefreshRuntime$) {\n  console.warn('remix:hmr: React Fast Refresh only works when the Remix compiler is running in development mode.');\n} else {\n  var prevRefreshReg = window.$RefreshReg$;\n  var prevRefreshSig = window.$RefreshSig$;\n  window.$RefreshReg$ = (type, id) => {\n    window.$RefreshRuntime$.register(type, \"\\\"app/components/SelfView.tsx\\\"\" + id);\n  }\n  window.$RefreshSig$ = window.$RefreshRuntime$.createSignatureFunctionForTransform;\n}\nimport * as __hmr__ from \"remix:hmr\";\nif (import.meta) {\n  import.meta.hot = __hmr__.createHotContext(\n  //@ts-expect-error\n  \"app/components/SelfView.tsx\");\n  import.meta.hot.lastModified = \"1738073419114.8167\";\n}\n// REMIX HMR END\n\nimport { forwardRef } from 'react';\nimport { cn } from '~/utils/style';\nimport { VideoSrcObject } from './VideoSrcObject';\nexport const SelfView = forwardRef(_c = ({\n  className,\n  ...rest\n}, ref) => <VideoSrcObject className={cn('-scale-x-100', className)} muted {...rest} ref={ref} />);\n_c2 = SelfView;\nSelfView.displayName = 'SelfView';\nvar _c, _c2;\n$RefreshReg$(_c, \"SelfView$forwardRef\");\n$RefreshReg$(_c2, \"SelfView\");\n\nwindow.$RefreshReg$ = prevRefreshReg;\nwindow.$RefreshSig$ = prevRefreshSig;"],
  "mappings": "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",
  "names": ["import_jsx_dev_runtime", "_c"]
}
